---
title: 'Efficacy of Transdiagnostic Cognitive-behavioral Therapy for Assertiveness:
  A Randomized Controlled Trial'
author:
- Tobias Hagberg^[University of Somewhere]
- Patrik Manhem^[University of Nowhere]
- Martin Oscarsson^[University of Nowhere]
- Fiona Michel^[University of Nowhere]
- Gerhard Andersson^[University of Nowhere]
- Per Carlbring^[University of Nowhere]
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  pdf_document:
    latex_engine: xelatex
    keep_tex: yes
  word_document: default
knit: (function(inputFile, encoding){
  rmarkdown::render(inputFile, encoding = encoding, output_format = "all") })
tags:
- nothing
- nothingness
bibliography:
- packages.bib
- KSH.bib
- DBT.bib
link-citations: yes
csl: apa.csl
lang: en-US
header-includes:
- \widowpenalties 1 150
- \setlength{\tabcolsep}{0bp}
- \usepackage{fontspec}
- \setmainfont[BoldFont={texgyretermes-bold.otf},ItalicFont={texgyretermes-italic.otf},BoldItalicFont={texgyretermes-bolditalic.otf}]{texgyretermes-regular.otf}
- \usepackage{unicode-math}
- \setmathfont{texgyretermes-math.otf}
- \hyphenation{}
editor_options: 
  chunk_output_type: console
---

```{r setup, include=F}

packages <-
  c(
    "pwr",
    "readxl",
    "writexl",
    "lmerTest",
    "dunn.test",
    "ggplot2",
    "tidyr",
    "jtools",
    "modelr",
    "ggeffects",
    "emmeans",
    "patchwork",
    "performance",
    "sjPlot",
    "kableExtra",
    "clinicalsignificance",
    "here",
    "MOTE"
  )
if (!require("install.load")) install.packages("install.load")
library(install.load)
install_load(packages)

knitr::opts_chunk$set(
  warning = F,
  message = F,
  echo = F,
  collapse = T,
  fig.retina = 4,
  dpi = 196,
  out.width = "100%",
  fig.width = 7.5,
  fig.asp = 0.618
)

xg1 = "unguided"
xg2 = "guided"
xg3 = "waitlist"
xG1 = "Unguided"
xG2 = "Guided"
xG3 = "Waitlist"

xpre = "pre measurement"
xdur = "during measurement"
xpost = "post measurement"
xfu = "follow-up measurement"
xPre = "Pre measurement"
xDur = "During measurement"
xPost = "Post measurement"
xFu = "Follow-up measurement"

xt1 = "pre"
xt2 = "during"
xt3 = "post"
xt4 = "followup"
xT1 = "Pre"
xT2 = "During"
xT3 = "Post"
xT4 = "Followup"

```

```{r functions, eval = T, echo = F} 

xresult <-
  function(x, d = 2) {
    paste0("$",
           apa(
             value = x,
             decimals = d,
             leading = F
           ),
           "$")
  }

xresulttext <-
  function(x, d = 2) {
    apa(value = x,
        decimals = d,
        leading = F)
  }

xpercent <-
  function(x, d = 2) {
    paste0("$",
           apa(
             value = x,
             decimals = d,
             leading = F
           ),
           "$",
           "\\xspace%")
  }

xpr <- function(x, d = 3, a = NULL) {
  paste("$p_{", a, "}$",
        ifelse(x < 0.001, "< $.001$", ifelse(
          x < 0.05,
          paste0("= $", apa(
            value = x,
            decimals = d,
            leading = F
          ), "$"),
          ifelse(x > 0.05, "DO NOT REPORT", "= $.05$")
        )))
}

xprnot <- function(x, d = 3, a = NULL) {
  paste("$p_{", a, "}$",
        ifelse(x < 0.001, "< $.001$", ifelse(
          x < 0.05,
          paste0(" = $", apa(
            value = x,
            decimals = d,
            leading = F
          ), "$"),
          ifelse(x > 0.05, paste0(
            " = $", apa(
              value = x,
              decimals = d,
              leading = F
            ), "$"
          ), "= $.05$")
        )))
}

xps <- function(x) {
  paste(ifelse(
    x < 0.001,
    "\\textsuperscript{***}",
    ifelse(
      x < 0.01,
      "\\textsuperscript{**}",
      ifelse(x > 0.05, "", "\\textsuperscript{*}")
    )
  ))
}

xpss <- function(x) {
  paste(ifelse(
    x < 0.001,
    "\\hbox to 0bp{\\textsuperscript{***}}",
    ifelse(
      x < 0.01,
      "\\hbox to 0bp{\\textsuperscript{**}}",
      ifelse(x > 0.05, "", "\\hbox to 0bp{\\textsuperscript{*}}")
    )
  ))
}

report.anova <- function(anovaobj, row) {
  paste0(
    "$F$($",
    round(anovaobj$NumDF[row], 2),
    "$, $",
    round(anovaobj$DenDF[row], 2),
    "$",
    ") = $",
    round(anovaobj$`F value`[row], 2),
    "$, ",
    xpr(anovaobj$`Pr(>F)`[row])
  )
}

report.kw <- function(kwobj) {
  df <- length(kwobj$Z) - 1
  paste0("$\\chi^2$($",
         df,
         "$) = ",
         round(kwobj$chi2, 2),
         ", ",
         xpr(pchisq(kwobj$chi2, df, lower.tail = F)))
}

report.kwtext <-
  function(kwobj, contrast) {
    df <- length(kwobj$Z) - 1
    x <- paste0("$Z$(",
                df,
                ") = ",
                xresult(kwobj$Z[contrast], 2),
                ", ",
                xpr(kwobj$altP.adjusted[contrast]),a="Bonf")
    return(x)
  }

report.kwnot <- function(kwobj) {
  df <- length(kwobj$Z) - 1
  paste0(xprnot(pchisq(kwobj$chi2, df, lower.tail = F)))
}

# Better build custom contrasts with less comparisons?
# https://aosmith.rbind.io/2019/04/15/custom-contrasts-emmeans/#reasons-for-custom-comparisons

rout <- function(lmerobj) {
  x.emmeans <- emmeans(lmerobj, ~ c(time,group))
  excluderows <- -c(3, 13, 22, 31:38)
  x.emmpairs <-
    pairs(
      x.emmeans,
      adjust = "bonferroni"
    )[excluderows]
  x.sd <-
    sqrt(as.data.frame(VarCorr(lmerobj))[1, 4] + as.data.frame(VarCorr(lmerobj))[2, 4])
  x.effectsizes <-
    eff_size(x.emmeans[effsel.group], sigma = x.sd, edf = df.residual(lmerobj))
  return(
    list(
      emmeans = as.data.frame(x.emmeans),
      emmpairs = as.data.frame(x.emmpairs),
      sd = x.sd,
      effectsizes = as.data.frame(x.effectsizes)
    )
  )
}

effsize.tabrow2 <- function(outobj, contrast, direction, stars = "stars") {
  effrow <- which(outobj$effectsizes$contrast == contrast)
  stars <-  if( stars == "nostars" ) {} else {
      stars <-
    xpss(outobj$emmpairs$p.value[effrow])
  }
  if (direction == -1) {
    lower = outobj$effectsizes$upper.CL[effrow] * direction
    upper = outobj$effectsizes$lower.CL[effrow] * direction
  } else {
    lower = outobj$effectsizes$lower.CL[effrow] * direction
    upper = outobj$effectsizes$upper.CL[effrow] * direction
  }
  paste0(
    "\\parbox[b]{4.25em}{\\flushright",
    xresult(outobj$effectsizes$effect.size[effrow] * direction, 2),
    "}",
    "~[",
    xresult(lower, 2),
    ", ",
    xresult(upper, 2),
    "]",
    stars
  )
}

report.text <-
  function(outobj, effrow, direction = 1, emmpairsrow) {
    if (direction == -1) {
      lower = outobj$effectsizes$upper.CL[effrow] * direction
      upper = outobj$effectsizes$lower.CL[effrow] * direction
    } else {
      lower = outobj$effectsizes$lower.CL[effrow] * direction
      upper = outobj$effectsizes$upper.CL[effrow] * direction
    }
    paste0(
      "$\\Delta M$ = ",
      xresult(outobj$emmpairs$estimate[emmpairsrow] * direction, 1),
      # ", $t$\\(_{",
      ", $t$($",
      xresulttext(outobj$emmpairs$df[emmpairsrow], 0),
      #"}\\) = ",
      "$) = ",
      xresult(outobj$emmpairs$t.ratio[emmpairsrow], 2),
      ", ",
      xpr(outobj$emmpairs$p.value[emmpairsrow],a="Bonf"),
      ", $ES$ = ",
      xresult(outobj$effectsizes$effect.size[effrow] * direction, 2),
      ", 95\\% CI [",
      xresult(lower, 2),
      ", ",
      xresult(upper, 2),
      "]"
    )
    return(x)
  }

report.text2 <-
  function(outobj, contrast, direction = 1, stats = "allshort") {
    effrow <- which(outobj$effectsizes$contrast == contrast)
    if (direction == -1) {
      lower = outobj$effectsizes$upper.CL[effrow] * direction
      upper = outobj$effectsizes$lower.CL[effrow] * direction
    } else {
      lower = outobj$effectsizes$lower.CL[effrow] * direction
      upper = outobj$effectsizes$upper.CL[effrow] * direction
    }
    x.delta <- paste0(
      "$\\Delta M$ = ",
      xresult(outobj$emmpairs$estimate[effrow] * direction, 1)
    )
    x.sig <- paste0(
      "$t$($",
      xresulttext(outobj$emmpairs$df[effrow], 0),
      "$) = ",
      xresult(outobj$emmpairs$t.ratio[effrow], 2),
      ", ",
      xpr(outobj$emmpairs$p.value[effrow],a="Bonf")
    )
    x.sigshort <-
      xpr(outobj$emmpairs$p.value[effrow],a="Bonf")
    x.eff <- paste0(
      "$ES$ = ",
      xresult(outobj$effectsizes$effect.size[effrow] * direction, 2),
      ", 95\\% CI [",
      xresult(lower, 2),
      ", ",
      xresult(upper, 2),
      "]"
    )
    x.effshort <- paste0(
      "$ES$ = ",
      xresult(outobj$effectsizes$effect.size[effrow] * direction, 2)
    )
    output <- if (stats == "sigshort") {
      x.sigshort
    } else if (stats == "sig") {
      x.sig
    } else if (stats == "delta") {
      x.delta
    } else if (stats == "effshort") {
      x.effshort
    } else if (stats == "eff") {
      x.eff
    } else if (stats == "sigeffshort") {
      paste0(x.sigshort,", ",x.effshort)
    } else if (stats == "allshort") {
      paste0(x.delta, ", ", x.sig, ", ", x.effshort)
    } else if (stats == "all") {
      paste0(x.delta, ", ", x.sig, ", ", x.eff)
    }
    return(output)
  }

effsize.tabrow <- function(outobj, contrast, direction) {
  effrow <-
    which(rout(aaas_ad.lmer)$effectsizes$contrast == contrast)
  stopifnot(all(outobj$emmpairs[-c(3, 13, 22, 31:38), ][, 1] == outobj$effectsizes[, 1]))
  stars <-
    xpss(outobj$emmpairs[-c(3, 13, 22, 31:38), ]$p.value[effrow])
  if (direction == -1) {
    lower = outobj$effectsizes$upper.CL[effrow] * direction
    upper = outobj$effectsizes$lower.CL[effrow] * direction
  } else {
    lower = outobj$effectsizes$lower.CL[effrow] * direction
    upper = outobj$effectsizes$upper.CL[effrow] * direction
  }
  linebreak(paste0(
    xresult(outobj$effectsizes$effect.size[effrow] * direction, 2),
    " [",
    xresult(lower, 2),
    ", ",
    xresult(upper, 2),
    "]",
    stars
  ),
  align = "c")
}

```

# Introduction

Experiences of stress, anxiety, and depression are often associated with avoidance. A person who is all too stressed from an ever-increasing workload may want nothing more than to tell their supervisor there are too many tasks on the table, yet still takes on another assignment when the supervisor asks. A person with social anxiety may want nothing more than to take part in social gatherings, yet chooses to abstain to avoid the feeling of being judged or scrutinized by others. A person who is depressed may want nothing more than to call a friend, yet chooses not to, for fear of being put down if the friend does not pick up the phone. These behaviors may all be associated with inadequate assertiveness, i.e., avoidance of constructively presenting one’s thoughts, feelings, needs, and wishes in relation to others.

Assertiveness can be difficult to delineate from social skills in general [@LINEHAN1979], but a common definition is “direct, firm, positive [...] action [enabling] us to act in our own best interests, to stand up for ourselves without undue anxiety, to exercise personal rights without denying the rights of others, and to express our feelings and needs [...] honestly and comfortably” [@alberti2017your,p.34]. Examples include politely saying ‘no’ to a boss requesting undue overtime, actively participating in social activities, accepting/acknowledging a compliment without deflecting, and verbalizing feelings in personal relationships without acting out. Lack of assertiveness is associated with several psychological problems, including stress, anxiety, depression, and panic disorder, as well as emotional instability, strained relationships, and low self-esteem [@Speed2018a]. While there are diagnoses, diagnostic tools, and treatment manuals for these conditions, no evidence-based interventions specifically target assertiveness for a broader population.

Assertiveness training in general, however, goes back to the very first behavioral therapies, for example, as described by @salter1949conditioned or @Wolpe1966. Assertiveness was presented as a behavioristic alternative to psychoanalysis. In the 1970s, the concept was popularized in self-help books by @alberti1974your, @smith1975say, as well as @fensterheim1975don. Research in assertiveness training peaked in the 1980s [@Speed2018a]. Although the behavioral techniques of the first wave of therapy were supplemented by cognitive restructuring techniques [e.g. @beck1979cognitive] in the following decades, techniques such as modeling and behavior rehearsal have remained active parts of treatments for psychological syndromes such as anxiety disorders and depression. The @LINEHAN1979 manual for assertion therapy combining behavior rehearsal with cognitive restructuring was a stepping stone towards Dialectical Behavior Therapy (DBT), of which assertion skills training in a group setting is an integral part @linehan1993skills.

Building on the definition from @alberti2017your, assertiveness can be operationalized as acting with respect to personal rights without infringing on the rights of others. A constructive assertion takes into account both the desired result of the interaction (e.g. having said no to someone else’s demand, or having made a request) and the intensity of the interaction, where the latter is calibrated with regards to both the importance of the relationship and what @linehan1993skills refers to as ‘self-respect’. Assertive behavior, using this definition, can be thought of as the product of respect for the rights of others, and respect for the rights of oneself. This definition offers plenty of opportunities for idiographic and contextual descriptions of assertion in therapy, i.e. when designing in vivo behavioral experiments, regardless of cultural influences on what is considered to be acceptable behavior (within a family, community, society, et.c.).

@Speed2018a conclude that while assertiveness training remains part of DBT, as well as acceptance and commitment therapy (ACT), general assertiveness training has otherwise fallen by the wayside in favor of interventions designed for specific psychiatric disorders. Very little research on assertiveness training has been published since the early 1980s. Recent exceptions include @Baker2015, showing a negative relationship between social anxiety and assertiveness, @Vagos2019 showing a negative relationship between mental distress in general and assertiveness, and @Antunez2020, highlighting a link between circadian typology and different constructs related to mental health, among them levels of assertiveness. @Speed2018a further conclude that there is potential for assertiveness training as an intervention for individuals suffering from anxiety and depression, and as a means to increase relationship satisfaction. The lack of contemporary evidence for the assertiveness construct and assertiveness training as a transdiagnostic intervention calls for new research on the subject.

The Western Australian Centre for Clinical Interventions (CCI) offers various self-help resources for mental health problems. These resources include Assert Yourself [@michel2008], a series of ten modules with concepts and strategies primarily based on CBT, with a focus on assertiveness. While current evidence for assertiveness training is scarce, at best, there is great evidence for CBT for symptoms and syndromes associated with inadequate assertiveness. In a review of meta-analyses, @Hofmann2012 conclude that CBT is one of the most effective forms of therapy. This includes the application for symptoms related to trauma and stress, as well as syndromes related to depression and anxiety. A review by @Andrews2018 also lends support to internet-delivered CBT (iCBT) for anxiety and depression, showing an average between-group effect size $g$ = $0.8$, compared to controls. @Carlbring2018 have also shown that iCBT, on average, produces equivalent overall effects compared to face-to-face treatment. iCBT has been proven effective both in guided and unguided applications (i.e., with or without therapist support), though guided iCBT tends to produce slightly larger effects [@Baumeister2014a]. iCBT has also been proven effective in transdiagnostic applications, including interventions targeting stress [@Day2013], procrastination [@Rozental2015], and perfectionism [@Rozental2017].

This study aims to evaluate the effects of an eight-week iCBT intervention for assertiveness, Respekt^2^, based on the @michel2008 modules, through a randomized controlled trial. The research questions are:

- What are the effects on assertiveness of guided and unguided participation in Respekt^2^, compared to a waitlist control?

- What are the effects of guided and unguided participation on measures of anxiety and depression, compared to the control?

```{r prepare.data, echo = F, eval = F}

## Export settings

# - 2020-01-27 "Respekt i kvadrat - förmätning" PRE Groups 1+2+3
# - 2020-03-09 "Respekt i kvadrat - mittmätning utan Corona" DUR Groups 1+2+3
# - 2020-04-06 "Respekt i kvadrat - eftermätning" POST Groups 1+2
# - 2020-04-06 "Respekt i kvadrat - eftermätning väntelista" POST Group 3
# - 2021-04-21 "Respekt i kvadrat - 1-årsuppföljning" FU Groups 1+2

# Export settings recorded in "Screenshot 2021-12-12 at 11-29-37 Exportera.png"

raw_excel = "Respekt_surveys_211213_101425.xlsx"
r2fu.raw.data <- read_excel(raw_excel)

# Remove cases that meet exclusion criteria but were erroneously included in the study
r2fu.raw.data <- r2fu.raw.data[-c(13,48,52,97,158),]

# Missing data as NA values
r2fu.raw.data[r2fu.raw.data == "[missing data]" ] <- NA

# As dataframe
r2fu.raw.data <- as.data.frame(r2fu.raw.data)

# Unite POST measurements for Groups 1 + 2 with those for Group 3
cols.count <- 21
g3key <- which(!is.na(r2fu.raw.data[3 * cols.count + 8]))
r2fu.raw.data[g3key, c(1:cols.count) + 2 * cols.count] <-
  r2fu.raw.data[g3key, c(1:cols.count) + 3 * cols.count] # 2do: check if this is correct

# Create vector with group designations
r2fu.groups <-
  factor(ifelse(
    grepl("Grupp 1", r2fu.raw.data[,3]),
    1,
    ifelse(
      grepl("Grupp 2", r2fu.raw.data[,3]),
      2,
      ifelse(grepl("Grupp 3", r2fu.raw.data[,3]), 3, NA)
    )
  ),
  levels = c(3,1,2),
  labels = c(xg3,xg1,xg2))

# Only keep relevant columns
r2fu.raw.data <-
  r2fu.raw.data[, c(
    c(9:cols.count) + 0 * cols.count,
    c(9:cols.count) + 1 * cols.count,
    c(9:cols.count) + 2 * cols.count,
    c(9:cols.count) + 4 * cols.count
  )]

# Set colnames
timepoint.names <- c(1,2,3,4)
scale.names <- c(
  "rathus",
  "aaas_ag",
  "aaas_ad",
  "lsas_anx",
  "lsas_avo",
  "lsas_int",
  "lsas_per",
  "lsas_sum",
  "gad_sum",
  "phq_sum",
  "phq_sui",
  "phq_q10",
  "well"
)
colnames(r2fu.raw.data) <- paste(scale.names,rep(timepoint.names,each=length(scale.names)),sep=".")

# Add anonymous subject IDs
r2fu.raw.data$subject <- factor(c(1:length(r2fu.raw.data[,1]))) 

# Add in group designations
r2fu.raw.data$group <- r2fu.groups 

# Make sure numericals are numeric
r2fu.raw.data[, c(1:52)] <-
  sapply(r2fu.raw.data[, c(1:52)], as.numeric)

# Save anonymised data in wide format
saveRDS(r2fu.raw.data,file="r2fu.raw.data.RDS")

# Pivot to long format
r2fu.long.data <- r2fu.raw.data %>%
  pivot_longer(c(1:52),
               names_to = c(".value", "time"),
               names_pattern = "(.*).(\\d+)") %>% as.data.frame()
r2fu.long.data$time <- as.factor(r2fu.long.data$time)
saveRDS(r2fu.long.data,file="r2fu.long.data.RDS")
write_xlsx(r2fu.long.data, "r2fu.long.data.xlsx")

# Pivot back to wide format (should be equivalent to raw data)
r2fu.wide.data <- r2fu.long.data %>%
  pivot_wider(names_from = time,
              names_sep = ".",
              values_from = scale.names) %>% as.data.frame()
saveRDS(r2fu.wide.data,file="r2fu.wide.data.RDS")
write_xlsx(r2fu.wide.data, "r2fu.wide.data.xlsx")

```

```{r import.data, echo = F, eval = T}

r2fu.wide.data <- readRDS("r2fu.wide.data.RDS")
r2fu.long.data <- readRDS("r2fu.long.data.RDS")

# Update factor labels to use initial Uppercase character
r2fu.long.data$time <- factor(r2fu.long.data$time, labels = c(xT1,xT2,xT3,xT4))
r2fu.long.data$group <- factor(r2fu.long.data$group, labels = c(xG3,xG1,xG2))

```

# Method

## Ethics and pre-registration

Before recruitment started, the study received ethics approval from the Swedish Ethical Review Authority (Diary number: 2019-05165). The study was pre-registered at ClinicalTrials.gov (NCT04240249).

## Design

```{r powercalc, echo = F, eval = F}

round(pwr.f2.test(
  u = 3,
  v = NULL, # Solve for sample size
  f2 = 0.8,
  power = 0.9,
  sig.level = 0.05
)$v / 0.85 ^ 8,
digits = -1) * 3

```

The study design follows the RCT criteria proposed by @Chambless2001, with a randomized allocation of participants to three groups: (1) Guided self-help, (2) Unguided self-help, and (3) a ten-week Waitlist control. A sample size of 210 participants (70 per group) was decided on through an a priori power calculation according to guidelines for linear models outlined in @cohen1988statistical, assuming a between-group effect size of Cohen’s d of 0.80 on the Adaptive and Aggressive Assertiveness Scales [AAA-S\; @Thompson2011], power 0.90, alpha 0.05, and a 15% drop-out rate per week, with a duration of the intervention of 8 weeks in total.

## Participants

Participants were recruited from the public through advertisements on social media and other websites. Interested individuals were referred to a purpose-built website with more information on the study, including criteria for participation. Participants were required to be Swedish citizens, at least 18 years of age, have access to the internet, and be fluent in Swedish. Information on the website also included risks associated with participation, as well as terms and conditions for participation. People were invited to submit their email addresses and those who did were sent a link to complete an online screening. The online screening included self-report measures of anxiety, depression, and assertiveness, as well as questions regarding socio-demographics, experiences of psychological treatment, any current medication, and motivation for participation. See Table 1 for a summary of socio-demographic characteristics collected Pre-treatment.

\begin{table}

\caption{\label{tab:demdata}Socio-demographic baseline characteristics of participants.}
\centering
\begin{tabular}[t]{>{\raggedright\arraybackslash}p{10em}>{\centering\arraybackslash}p{5em}>{\centering\arraybackslash}p{5em}>{\centering\arraybackslash}p{5em}>{\centering\arraybackslash}p{5em}}
\toprule
  & Waitlist & Unguided & Guided & Total\\
  & $n$ = 68 & $n$ = 67 & $n$ = 70 & $n$ = 205\\
\midrule
\addlinespace[0.3em]
\multicolumn{5}{l}{Age (years)}\\
\hspace{1em}M (SD) & 41 (8) & 41 (9) & 44 (10) & 42 (9)\\
\midrule
\addlinespace[0.3em]
\multicolumn{5}{l}{Sex (\%)}\\
\hspace{1em}Female & 91 & 79 & 93 & 88\\
\midrule
\addlinespace[0.3em]
\multicolumn{5}{l}{Civil status (\%)}\\
\hspace{1em}Single & 37 & 36 & 29 & 34\\
\hspace{1em}Partner & 19 & 25 & 17 & 20\\
\hspace{1em}Married & 37 & 28 & 49 & 38\\
\hspace{1em}Other & 7 & 10 & 6 & 8\\
\midrule
\addlinespace[0.3em]
\multicolumn{5}{l}{Highest educational level (\%)}\\
\hspace{1em}Other & 3 & 1 & 1 & 2\\
\hspace{1em}Middle school & 1 & 0 & 0 & 0\\
\hspace{1em}High school/college & 10 & 9 & 7 & 9\\
\hspace{1em}Vocational training & 7 & 4 & 7 & 6\\
\hspace{1em}Currently at university & 7 & 15 & 10 & 11\\
\hspace{1em}University degree & 71 & 70 & 74 & 72\\
\midrule
\addlinespace[0.3em]
\multicolumn{5}{l}{Occupation (\%)}\\
\hspace{1em}Other & 9 & 6 & 7 & 7\\
\hspace{1em}Student & 7 & 12 & 6 & 8\\
\hspace{1em}Employed & 74 & 76 & 76 & 75\\
\hspace{1em}Unemployed & 4 & 4 & 0 & 3\\
\hspace{1em}Retired & 0 & 0 & 4 & 1\\
\hspace{1em}Parental leave & 0 & 0 & 4 & 1\\
\hspace{1em}Sick leave & 6 & 1 & 3 & 3\\
\midrule
\addlinespace[0.3em]
\multicolumn{5}{l}{Use of psychotropic medications (\%)}\\
\hspace{1em}No & 76 & 70 & 67 & 71\\
\hspace{1em}Yes, previously & 7 & 9 & 17 & 11\\
\hspace{1em}Yes, currently & 16 & 21 & 16 & 18\\
\midrule
\addlinespace[0.3em]
\multicolumn{5}{l}{Previous psychological treatment (\%)}\\
\hspace{1em}No & 38 & 40 & 39 & 39\\
\hspace{1em}Yes & 62 & 60 & 61 & 61\\
\bottomrule
\end{tabular}
\end{table}

In total, 657 individuals submitted their email addresses, of which 464 completed the screening questionnaire. Among those, 126 were excluded for meeting exclusion criteria. Exclusion criteria were concurrent psychological treatment, a recent change in psychotropic medication, lack of time and/or motivation for participation, and a rating of 15 or above on the PHQ-9 measure of depression. The remaining 338 individuals were invited to participate in the study. Of those, 253 accepted the invitation.

## Procedure

Following the a priori power calculation, 210 participants were randomized to be included in the study. The remaining 43 individuals were offered access to treatment materials but were excluded from all analyses. The 210 participants were randomized to the three treatment conditions. Participants in the guided condition were randomized to one of two therapists. All randomization was performed by an independent third party at Stockholm University, using random.org [@RandomOrg] and sealedenvelope.com [@sealed].

## Measures

Data were collected using the below measures at four time-points: week 0 (pre-treatment), week 4 (midway through the intervention), week 8 (post-treatment), and at a one-year follow-up.

### Primary measures

Assertiveness style was measured using a Swedish translation (contributed by TH) of the Adaptive and Aggressive Assertiveness Scales [AAA-S\; @Thompson2011] which contained 30 items, including “When someone I don’t know well borrows something from me and forgets to return it, I… a. Demand it back b. Ask if she/he is done and ask for it back” (a. and b. both scored 1 = Never, 5 = Always). The AAA-S has good and excellent internal consistency for aggressive (0.88) and adaptive (0.93) assertiveness, respectively. A Swedish translation (contributed by TH) of the Rathus Assertiveness Schedule [RAS\; @Rathus1973] was used as an additional measure of assertiveness style with 30 items, including “I find it embarrassing to return merchandise”, (+3 = Very characteristic of me, extremely descriptive, -3 = Very uncharacteristic of me, extremely nondescriptive).

### Secondary measures

Depression was measured using the Patient Health Questionnaire [PHQ-9\; @Kroenke2010] which contained nine items, including “Feeling down, depressed, or hopeless” (0 = Not at all, 3 = Nearly every day). Anxiety was measured using the Generalised Anxiety Disorder 7-item Scale [GAD-7\; @Kroenke2006] which contained seven items, including “Feeling nervous, anxious or on edge” (0 = Not at all, 3 = Nearly every day). Social anxiety was measured using the Liebowitz Social Anxiety Scale [LSAS-SR\; @Fresco2001] which contained 24 items, including “Calling someone you don’t know very well” (Fear or anxiety, 0 = None, 3 = Severe; Avoidance, 0 = Never, 3 = Usually). These self-report measures have reported either good or excellent internal consistency (0.87, 0.89, 0.92, and 0.96, respectively).

## Intervention

The intervention was based on the Assert Yourself modules by @michel2008, adapted to Swedish by TH with permission from the copyright holders. The self-help material teaches the distinction between different types of assertiveness (constructive, aggressive, passive, and passive-aggressive). It also aids the reader in finding reasons to act more assertive and constructive. The material is inspired by and cites works by @alberti1974your, @gambrill1975assertion, and @smith1975say, among others. In the material, assertiveness is described and operationalized based on the theoretic assumptions by @wolpe1990practice regarding reciprocal inhibition and classic conditioning: By assertively practicing the expression of feelings, wishes, and demands in anxiety-evoking situations and relationships, where the person was previously prone to non-assertive behavior, e.g., subdued disappointment or anger, a person may experience less discomfort from autonomous anxiety responses, over time. This is to be practiced in vivo, not just by acting. The long-term goal is to learn how to inhibit anxiety by being assertive. In cases where a physical counterpart is missing and anxiety is invoked by places, objects, or words, @Wolpe1952 suggests relaxation as a means to inhibit the anxiety response.

The material also includes a rationale for cognitive restructuring with methods by @beck1979cognitive, @Clark1986, @clark1995cognitive, and @powell2017mental. Through behavioral experiments, readers are to test the validity of negative thoughts, to achieve greater flexibility in responses. Furthermore, the material includes a passage on progressive muscle relaxation, for the reader to recognize bodily tension, reduce general strain, and practice an active coping technique for stressful situations. Finally, chapters on specific challenges, such as saying no, dealing with criticism, and coping with disappointment, conclude the material.

The Swedish adaptation prompted additions to @michel2008, some of which are presented in this paragraph. Based on recent research on exposure and inhibitory learning [e.g., @Craske2008], participants were encouraged to actively vary learning situations and work on new skills in as many environments as possible. In another new passage, inspired by the works on acceptance by Hayes [e.g., -@Hayes2004a] and others, participants were encouraged to actively search for and remain in the respondent discomfort they previously avoided. In line with Öst’s [-@ost2006tillampad] recommendations for applied tension, progressive muscle relaxation was introduced early in the intervention and expanded over several weeks. The written material was also complemented by downloadable audio with relaxation exercises, video of conversations and role-playing, and several new, interactive exercises.

Additional support for participants in the Guided self-help condition included weekly messages in the treatment platform, involving homework feedback, encouragement, validation, psychoeducation, and answers to any questions. Therapists were allocated 15 minutes of work, per participant and week.

### Therapists

Both therapists working with participants in the guided condition were final-year clinical psychology students at Stockholm University. Both had completed basic training in CBT and received continuous supervision from a licensed psychotherapist with more than two decades of iCBT experience.

## Data preparation

Five participants were excluded from the analyses due to wrongful inclusion as they were receiving concurrent psychological treatment.

```{bash, include = F, eval = T}

filename="flowchart"

cat <<EOF > $filename.dot
digraph G {

  dpi=600
  fontname=Helvetica
  fontsize=10
  node [ shape=box, fontname=Helvetica, fontsize=10, penwidth=0.5 ]
  compound=true
  #ranksep=.275
  ranksep=.3
  
  leads -> { screening_non_completers screening_completers }
  screening_completers -> { excluded invited }
  invited  -> { invitation_non_responders invitation_responders }
  invitation_responders -> { trimmed keepers }
  keepers -> randomization
  randomization -> { selfhelp_dur support_dur waitlist_dur }

  leads[label=<Leads from social media<BR/><I>n</I> = 657>]
  screening_completers[label=<Completed screening<BR/><I>n</I> = 464>]
  excluded[label=<Excluded from study<BR/><I>n</I> = 126, for the following reasons:<BR/>PHQ-9 cutoff (≥ 15), <I>n</I> = 77<BR/>Concurrent therapy, <I>n</I> = 29<BR/>Recent change in psychotropic drugs, <I>n</I> = 7<BR/>Low motivation/lack of time, <I>n</I> = 13>]
  screening_non_completers[label=<Did not complete screening<BR/><I>n</I> = 193>]
  invited[label=<Invited to participate in study<BR/><I>n</I> = 338>]
  invitation_non_responders[label=<Declined or did not respond<BR/><I>n</I> = 85>]
  invitation_responders[label=<Accepted invitation<BR/><I>n</I> = 253>]
  trimmed[label=<Excluded through randomization<BR/><I>n</I> = 43>]
  keepers[label=<Included through randomization<BR/><I>n</I> = 210>]
  randomization[label=<Randomization to condition<BR/><I>n</I> = 70 each>]
  selfhelp_dur[label=<Completed During measurement<BR/>(week 4)<BR/><I>n</I> = 44>]
  selfhelp_post[label=<Completed Post measurement<BR/>(week 8)<BR/><I>n</I> = 35>]
  selfhelp_fu[label=<Completed Follow-up measurement<BR/>(1 year)<BR/><I>n</I> = 30>]
  support_dur[label=<Completed During measurement<BR/>(week 4)<BR/><I>n</I> = 48>]
  support_post[label=<Completed Post measurement<BR/>(week 8)<BR/><I>n</I> = 50>]
  support_fu[label=<Completed Follow-up measurement<BR/>(1 year)<BR/><I>n</I> = 38>]
  waitlist_dur[label=<Completed During measurement<BR/>(week 4)<BR/><I>n</I> = 58>]
  waitlist_post[label=<Completed Post measurement<BR/>(week 8)<BR/><I>n</I> = 61>]
  itt[label=<Intention to treat<BR/><I>n</I> = 205>]

  subgraph cluster_selfhelp { margin=8; penwidth=0.5; labelloc="t"; color=black; bgcolor=white; label=<Unguided self-help<BR/><I>n</I> = 70 – 3 (excluded) = 67> ; selfhelp_dur -> selfhelp_post -> selfhelp_fu; } 
  subgraph cluster_support { margin=8; penwidth=0.5; labelloc="t"; color=black; bgcolor=white; label=<Guided self-help<BR/><I>n</I> = 70> ; support_dur -> support_post -> support_fu; } 
  subgraph cluster_waitlist { margin=8; penwidth=0.5; labelloc="t"; color=black; bgcolor=white; label=<Waitlist<BR/><I>n</I> = 70 – 2 (excluded) = 68> ; waitlist_dur -> waitlist_post; } 
  { selfhelp_fu support_fu waitlist_post } -> itt

}
EOF

/opt/homebrew/bin/dot -Tpng -o$filename.png $filename.dot
/opt/homebrew/bin/dot -Tpdf -o$filename.pdf $filename.dot
/Library/TeX/texbin/pdfcrop $filename.pdf $filename.pdf

```

```{r flowchartout, out.width="100%", fig.align="center", fig.cap="A total of 210 participants were included in the study through randomization; they were further randomized into groups Unguided self-help, Guided self-help, and Waitlist, with 70 participants each."}

knitr::include_graphics("flowchart.png", auto_pdf = T)

```

## Analysis

All data were organized in one dataset and analyzed using `r R.Version()$language` `r paste(R.Version()[c("major", "minor")], collapse = ".")`, using lmerTest [@R-lmerTest], emmeans [@R-emmeans], ggeffects [@R-ggeffects], performance [@R-performance], and clinicalsignificance [@R-clinicalsignificance] packages. All syntax is available at https://github.com/hmep/r2fu/, together with anonymized data. 

A linear mixed-effects model was fitted using unscaled data to estimate fixed effects of group, time, and group-time interaction, and random effects of participant (specifying a random intercept to control for individual differences), using an unstructured covariance pattern, and the REML method of estimation. Kenward-Roger approximations were used to estimate denominator degrees of freedom. Post-hoc pairwise comparisons of estimated marginal means were performed using T-tests. Significance of all post-hoc tests were decided with Bonferroni-corrected p-values. The proportions of participants showing reliable change and reaching clinical significance were determined following @Jacobson1991, using the 'c' definition to select the cutoff value. To honor the intention to treat principle in the analysis of clinical significance, any missing values were filled in with the value from the previous time point.

```{r mixedmodels, fig.width = 13, fig.asp = 0.75, echo = F, eval = T, results='hide'}

lnT4 <-!grepl(xT4, r2fu.long.data$time)

### Primary measures

aaas_ad.post.lmer <-
  lmerTest::lmer(
    aaas_ad ~ group * time + (1 | subject),
    data = r2fu.long.data[lnT4,],
    na.action = na.omit,
    REML = T
  )
# performance::check_model(aaas_ad.lmer) # Checked, found to be OK!
aaas_ad.post.anova <- anova(aaas_ad.post.lmer, type=3, ddf="Kenward-Roger") # Significant interaction time x group
aaas_ad.lmer <-
  lmerTest::lmer(
    aaas_ad ~ group * time + (1 | subject),
    data = r2fu.long.data,
    na.action = na.omit,
    REML = T
  )
# performance::check_model(aaas_ad.lmer) # Checked, found to be OK!
aaas_ad.anova <- anova(aaas_ad.lmer, type=3, ddf="Kenward-Roger")
aaas_ad.emm.plot <-
  plot(
    ggemmeans(aaas_ad.lmer, terms = c("time", "group")),
    show.title = F,
    show.x.title = F,
    colors = "bw",
    connect.lines = T,
    line.size = .4,
    dot.size = 3
  ) + scale_shape_manual(values=c(1, 17, 15))
aaas_ad.emm.plot <- aaas_ad.emm.plot +
  labs(y = "AAA-S, Adaptive subscale") + theme_apa(legend.pos = "topleft", legend.font.size = 12, y.font.size = 10)

aaas_ag.post.lmer <-
  lmerTest::lmer(
    aaas_ag ~ group * time + (1 | subject),
    data = r2fu.long.data[lnT4,],
    na.action = na.omit,
    REML = T
  )
# performance::check_model(aaas_ag.lmer) # Checked, found to be OK!
aaas_ag.post.anova <- anova(aaas_ag.post.lmer, type=3, ddf="Kenward-Roger") # Significant interaction time x group
aaas_ag.lmer <-
  lmerTest::lmer(
    aaas_ag ~ group * time + (1 | subject),
    data = r2fu.long.data,
    na.action = na.omit,
    REML = T
  )
# performance::check_model(aaas_ag.lmer) # Checked, found to be OK!
aaas_ag.anova <- anova(aaas_ag.lmer, type=3, ddf="Kenward-Roger")
aaas_ag.emm.plot <-
  plot(
    ggemmeans(aaas_ag.lmer, terms = c("time", "group")),
    show.title = F,
    show.x.title = F,
    colors = "bw",
    connect.lines = T,
    line.size = .4,
    dot.size = 3
  ) + scale_shape_manual(values=c(1, 17, 15))
aaas_ag.emm.plot <- aaas_ag.emm.plot + 
  labs(y = "AAA-S, Aggressive subscale") + theme_apa(legend.pos = "topleft", legend.font.size = 12, y.font.size = 10)

rathus.post.lmer <-
  lmerTest::lmer(
    rathus ~ group * time + (1 | subject),
    data = r2fu.long.data[lnT4,],
    na.action = na.omit,
    REML = T
  )
# performance::check_model(rathus.lmer) # Checked, found to be OK!
rathus.post.anova <- anova(rathus.post.lmer, type=3, ddf="Kenward-Roger") # Significant interaction time x group
rathus.lmer <-
  lmerTest::lmer(
    rathus ~ group * time + (1 | subject),
    data = r2fu.long.data,
    na.action = na.omit,
    REML = T
  )
# performance::check_model(rathus.lmer) # Checked, found to be OK!
rathus.anova <- anova(rathus.lmer, type=3, ddf="Kenward-Roger")
rathus.emm.plot <-
  plot(
    ggemmeans(rathus.lmer, terms = c("time", "group")),
    show.title = F,
    show.x.title = F,
    colors = "bw",
    connect.lines = T,
    line.size = .4,
    dot.size = 3
  ) + scale_shape_manual(values=c(1, 17, 15))
rathus.emm.plot <- rathus.emm.plot +
  labs(y = "Rathus Assertiveness Schedule (RAS)") + theme_apa(legend.pos = "topleft", legend.font.size = 12, y.font.size = 10) 

### Secondary measures

lsas_sum.post.lmer <-
  lmerTest::lmer(
    lsas_sum ~ group * time + (1 | subject),
    data = r2fu.long.data[lnT4,],
    na.action = na.omit,
    REML = T
  )
# performance::check_model(lsas_sum.lmer) # Checked, found to be OK!
lsas_sum.post.anova <- anova(lsas_sum.post.lmer, type=3, ddf="Kenward-Roger") # Significant interaction time x group
lsas_sum.lmer <-
  lmerTest::lmer(
    lsas_sum ~ group * time + (1 | subject),
    data = r2fu.long.data,
    na.action = na.omit,
    REML = T
  )
# performance::check_model(lsas_sum.lmer) # Checked, found to be OK!
lsas_sum.anova <- anova(lsas_sum.lmer, type=3, ddf="Kenward-Roger")
lsas_sum.emm.plot <-
  plot(
    ggemmeans(lsas_sum.lmer, terms = c("time", "group")),
    show.title = F,
    show.x.title = F,
    colors = "bw",
    connect.lines = T,
    line.size = .4,
    dot.size = 3
  ) + scale_shape_manual(values=c(1, 17, 15))
lsas_sum.emm.plot <- lsas_sum.emm.plot +
  labs(y = "Liebowitz Social Anxiety Scale (LSAS-SR)") + theme_apa(legend.pos = "bottomleft", legend.font.size = 12, y.font.size = 10) +
  geom_hline(yintercept = lsas_sum.emm.plot$data$predicted[4], linetype="dotted")

phq_sum.post.lmer <-
  lmerTest::lmer(
    phq_sum ~ group * time + (1 | subject),
    data = r2fu.long.data[lnT4,],
    na.action = na.omit,
    REML = T
  )
# performance::check_model(phq_sum.lmer) # Checked, found to be OK!
phq_sum.post.anova <- anova(phq_sum.post.lmer, type=3, ddf="Kenward-Roger") # Significant interaction time x group
phq_sum.lmer <-
  lmerTest::lmer(
    phq_sum ~ group * time + (1 | subject),
    data = r2fu.long.data,
    na.action = na.omit,
    REML = T
  )
# performance::check_model(phq_sum.lmer) # Checked, found to be OK!
phq_sum.anova <- anova(phq_sum.lmer, type=3, ddf="Kenward-Roger")
phq_sum.emm.plot <-
  plot(
    ggemmeans(phq_sum.lmer, terms = c("time", "group")),
    show.title = F,
    show.x.title = F,
    colors = "bw",
    connect.lines = T,
    line.size = .4,
    dot.size = 3
  ) + scale_shape_manual(values=c(1, 17, 15))
phq_sum.emm.plot <- phq_sum.emm.plot +
  labs(y = "Patient Health Questionnaire, 9 items (PHQ-9)") + theme_apa(legend.pos = "bottomleft", legend.font.size = 12, y.font.size = 10) +
  geom_hline(yintercept = phq_sum.emm.plot$data$predicted[1], linetype="dotted")

gad_sum.post.lmer <-
  lmerTest::lmer(
    gad_sum ~ group * time + (1 | subject),
    data = r2fu.long.data[lnT4,],
    na.action = na.omit,
    REML = T
  )
# performance::check_model(gad_sum.post.lmer) # Checked, found to be OK!
gad_sum.post.anova <- anova(gad_sum.post.lmer, type=3, ddf="Kenward-Roger") # Significant interaction time x group
gad_sum.lmer <-
  lmerTest::lmer(
    gad_sum ~ group * time + (1 | subject),
    data = r2fu.long.data,
    na.action = na.omit,
    REML = T
  )
# performance::check_model(gad_sum.lmer) # Checked, found to be OK!
gad_sum.anova <- anova(gad_sum.lmer, type=3, ddf="Kenward-Roger")
gad_sum.emm.plot <-
  plot(
    ggemmeans(gad_sum.lmer, terms = c("time", "group")),
    show.title = F,
    show.x.title = F,
    colors = "bw",
    connect.lines = T,
    line.size = .4,
    dot.size = 3
  ) + scale_shape_manual(values=c(1, 17, 15))
gad_sum.emm.plot <- gad_sum.emm.plot +
  labs(y = "Generalised Anxiety Disorder 7-item Scale (GAD-7)") + theme_apa(legend.pos = "bottomleft", legend.font.size = 12, y.font.size = 10) +
  geom_hline(yintercept = gad_sum.emm.plot$data$predicted[4], linetype="dotted")

```

```{r predictions, eval = T}

### Output predictions to new data frame

# Create new data frame with factor variables in place
r2fu.predicted.data <- r2fu.long.data[,c(1:3)]

# Add predicted values to data frame
r2fu.predicted.data <- r2fu.predicted.data %>% spread_predictions(
  rathus.lmer,
  aaas_ag.lmer,
  aaas_ad.lmer,
  lsas_sum.lmer,
  gad_sum.lmer,
  phq_sum.lmer
)

# Set column names
colnames(r2fu.predicted.data) <-
  c(
    "subject",
    "group",
    "time",
    "rathus",
    "aaas_ag",
    "aaas_ad",
    "lsas_sum",
    "gad_sum",
    "phq_sum"
  )

```

```{r emmeff, echo = F, eval = T}

effsel.group <- c(1:3,5:8,9:12)
effsel.time <- -10

```

# Results

```{r emm.primary.plots, fig.width = 10, fig.asp = 0.8, echo = F, fig.cap = 'Plots of estimated fixed effects for two of the primary transdiagnostic scales used to measure skillful, assertive behaviors. Participants’ estimated means for both measures exhibit increasing levels of assertiveness during the course of treatment in the Unguided self-help and Guided self-help groups, with negligable differences between the two treatment conditions. The trends continue beyond the Post time point, showing further increased estimated mean levels of assertive behaviors at 1-year Follow-up. The Waitlist group’s means recovered slightly, although not significantly, between the Pre and Post time points, for both measures.'}

(aaas_ad.emm.plot + theme(plot.margin = unit(c(0,8,0,0), "pt"))) +
  (aaas_ag.emm.plot + theme(plot.margin = unit(c(0,0,0,8), "pt"))) +
  (rathus.emm.plot + theme(plot.margin = unit(c(0,8,0,0), "pt"))) + 
  guide_area() + plot_layout(guides = 'collect') + plot_layout(ncol = 2) 

```

```{r emm.secondary.plots, fig.width = 10, fig.asp = 0.8, echo = F, fig.cap = 'Plots of estimated fixed effects for secondary syndromal outcome measures. Participation in the Unguided self-help and Guided self-help conditions lead to significant symptom alleviation between the Pre and Post as well as between Pre and 1-year Follow-up time points for depression and social anxiety, as captured with their respective measures. As with the transdiagnostic measures of assertive behaviors, the difference between the two time points was small or statistically inappreciable for both groups and both measures. The Waitlist control group did not significantly change between time points for either measure. However, to counteract even the slightest nocebo effect of Waitlist in the between-group comparisons the most conservative estimate for the Waitlist control condition was used; see dotted line.'}

(phq_sum.emm.plot + theme(plot.margin = unit(c(0,8,0,0), "pt"))) +
  (gad_sum.emm.plot + theme(plot.margin = unit(c(0,0,0,8), "pt"))) +
  (lsas_sum.emm.plot + theme(plot.margin = unit(c(0,8,0,0), "pt"))) + 
  guide_area() + plot_layout(guides = 'collect') + plot_layout(ncol = 2) 

```

```{r measures, echo = F, eval = T}

### AAA-S Adaptive assertiveness
# Norms: Thompson (2011) 
# Adaptive assertiveness
# Student sample 1: 57.6 (7.5), alpha .82 <- Let's use these
# Student sample 2: 56.8 (7.4), alpha .82
# Clinical sample: 50.0 (8.4), alpha .69
r.AAAS_ad = 0.82 # s 329 @Thompson2011
sd.AAAS_ad.norm = 7.5 # s 329 @Thompson2011
mean.AAAS_ad.norm = 57.6 # s 329 @Thompson2011
ref.AAAS_ad = "icke-kliniskt stickprov (student-sample 1) från @Thompson2011"

### AAA-S Aggressive assertiveness
# Norms: Thompson (2011) 
# Aggressive assertiveness
# Student sample 1: 33.2 (9.7), alpha .88 <- Let's use these
# Student sample 2: 31.6 (8.7), alpha .87
# Clinical sample: 27.5 (7.6), alpha .82
r.AAAS_ag = 0.88 # s 329 @Thompson2011
sd.AAAS_ag.norm = 9.7 # s 329 @Thompson2011
mean.AAAS_ag.norm = 33.2 # s 329 @Thompson2011
ref.AAAS_ag = "icke-kliniskt stickprov (student-sample 1) från @Thompson2011"

### PHQ9
# Normdata: Kroenke, K., Spitzer, R. L., & Williams, J. B. (2001). The PHQ-9: validity of a brief depression severity measure. Journal of General Internal Medicine, 16(9), 606–613. Retrieved from http://www.ncbi.nlm.nih.gov/pubmed/11556941
r.PHQ9 = 0.89 # @Kroenke2001 s 3
sd.PHQ9.norm = 3.8 # @Kroenke2001 s 3
mean.PHQ9.norm = 3.3 # @Kroenke2001 s 3
ref.PHQ9 = "icke-kliniskt stickprov från @Kroenke2001"

### GAD7
# Normdata: Spitzer, R. L., Kroenke, K., Williams, J. B. W., & Löwe, B. (2006). A Brief Measure for Assessing Generalized Anxiety Disorder. Archives of Internal Medicine, 166(10), 1092. https://doi.org/10.1001/archinte.166.10.1092
# Löwe, B., Decker, O., Müller, S., Brähler, E., Schellberg, D., Herzog, W., & Herzberg, P. Y. (2008). Validation and Standardization of the Generalized Anxiety Disorder Screener (GAD-7) in the General Population. Medical Care, 46(3), 266–274. https://doi.org/10.1097/MLR.0b013e318160d093
r.GAD7 = 0.92 # @Kroenke2006 s 3
sd.GAD7.norm = 4.8 # @Kroenke2006 s 3
mean.GAD7.norm = 4.9 # @Kroenke2006 s 3
ref.PHQ9 = "icke-kliniskt stickprov från @Kroenke2006"

### LSAS-24
# Normdata: Fresco, D. M., Coles, M. E., Heimberg, R. G., Liebowitz, M. R., Hami, S., Stein, M. B., & Goetz, D. (2001). The Liebowitz Social Anxiety Scale: a comparison of the psychometric properties of self-report and clinician-administered formats. Psychol Med 31, 1025-1035.
# Svenska normer: https://www.fbanken.se/form/34/liebowitz-social-anxiety-scale-self-report
r.LSAS24 = 0.96 # @Fresco2001 s 1026
sd.LSAS24.norm = 12.70 # @Fresco2001 s 1031
mean.LSAS24.norm = 13.49 # @Fresco2001 s 1031
ref.LSAS24 = "icke-kliniskt stickprov från @Fresco2001"

### Rathus
# Normdata: Thompson (2011) 
r.Rathus = 0.87 # s 326 @Thompson2011
sd.Rathus.norm = 23.9 # s 326 @Thompson2011
mean.Rathus.norm = 6.2 # s 326 @Thompson2011
ref.Rathus = "icke-kliniskt stickprov (student-sample 1) från @Thompson2011"

measurementnames <-
  c("AAA-S Adaptive",
    "AAA-S Aggressive",
    "RAS",
    "PHQ-9",
    "GAD-7",
    "LSAS-SR")

measurementshortnames <-
  c("aaas_ad",
    "aaas_ag",
    "rathus",
    "phq_sum",
    "gad_sum",
    "lsas_sum")

norms <- rbind(
  c(r.AAAS_ad, mean.AAAS_ad.norm, sd.AAAS_ad.norm),
  c(r.AAAS_ag, mean.AAAS_ag.norm, sd.AAAS_ag.norm),
  c(r.Rathus, mean.Rathus.norm, sd.Rathus.norm),
  c(r.PHQ9, mean.PHQ9.norm, sd.PHQ9.norm),
  c(r.GAD7, mean.GAD7.norm, sd.GAD7.norm),
  c(r.LSAS24, mean.LSAS24.norm, sd.LSAS24.norm)
)

```


```{r collectoutput, echo = F, eval = T}

aaas_ad.out <- rout(aaas_ad.lmer)
aaas_ag.out <- rout(aaas_ag.lmer)
rathus.out <- rout(rathus.lmer)
phq_sum.out <- rout(phq_sum.lmer)
gad_sum.out <- rout(gad_sum.lmer)
lsas_sum.out <- rout(lsas_sum.lmer)

```


```{r buildeffsizetab, echo = F, eval = T}

comparison <- linebreak(c(
  "Unguided self-help, Pre vs. Post",
  "Unguided self-help, Pre vs. Follow-up",
  "Unguided self-help, Post vs. Follow-up",
  "Guided self-help, Pre vs. Post",
  "Guided self-help, Pre vs. Follow-up",
  "Guided self-help, Post vs. Follow-up",
  "Waitlist, Pre vs. Post",
  "Unguided self-help at Post vs. Waitlist at Post",
  "Unguided self-help at Follow-up vs. Waitlist at Post",
  "Unguided self-help at Follow-up vs. Waitlist at \\dag",
  "Guided self-help at Post vs. Waitlist at Post",
  "Guided self-help at Follow-up vs. Waitlist at Post",
  "Guided self-help at Follow-up vs. Waitlist at \\dag",
  "Guided self-help at Post vs. Unguided at Post",
  "Guided self-help at Follow-up vs. Unguided at Follow-up"
  ), align = "r")

aaas_ad.effsizes <-
  c(
    effsize.tabrow2(aaas_ad.out,paste(xT1,xG1,"-",xT3,xG1),-1),
    effsize.tabrow2(aaas_ad.out,paste(xT1,xG1,"-",xT4,xG1),-1),
    effsize.tabrow2(aaas_ad.out,paste(xT3,xG1,"-",xT4,xG1),-1),
    effsize.tabrow2(aaas_ad.out,paste(xT1,xG2,"-",xT3,xG2),-1),
    effsize.tabrow2(aaas_ad.out,paste(xT1,xG2,"-",xT4,xG2),-1),
    effsize.tabrow2(aaas_ad.out,paste(xT3,xG2,"-",xT4,xG2),-1),
    effsize.tabrow2(aaas_ad.out,paste(xT1,xG3,"-",xT3,xG3),-1),
    effsize.tabrow2(aaas_ad.out,paste(xT3,xG3,"-",xT3,xG1),-1),
    effsize.tabrow2(aaas_ad.out,paste(xT3,xG3,"-",xT4,xG1),-1),
    "\\parbox{11.5em}{\\hfil{}(idem)\\hfil{}}",
    effsize.tabrow2(aaas_ad.out,paste(xT3,xG3,"-",xT3,xG2),-1),
    effsize.tabrow2(aaas_ad.out,paste(xT3,xG3,"-",xT4,xG2),-1),
    "\\parbox{11.5em}{\\hfil{}(idem)\\hfil{}}",
    effsize.tabrow2(aaas_ad.out,paste(xT3,xG1,"-",xT3,xG2),-1),
    effsize.tabrow2(aaas_ad.out,paste(xT4,xG1,"-",xT4,xG2),-1)
  )

aaas_ag.effsizes <-
  c(
    effsize.tabrow2(aaas_ag.out,paste(xT1,xG1,"-",xT3,xG1),-1),
    effsize.tabrow2(aaas_ag.out,paste(xT1,xG1,"-",xT4,xG1),-1),
    effsize.tabrow2(aaas_ag.out,paste(xT3,xG1,"-",xT4,xG1),-1),
    effsize.tabrow2(aaas_ag.out,paste(xT1,xG2,"-",xT3,xG2),-1),
    effsize.tabrow2(aaas_ag.out,paste(xT1,xG2,"-",xT4,xG2),-1),
    effsize.tabrow2(aaas_ag.out,paste(xT3,xG2,"-",xT4,xG2),-1),
    effsize.tabrow2(aaas_ag.out,paste(xT1,xG3,"-",xT3,xG3),-1),
    effsize.tabrow2(aaas_ag.out,paste(xT3,xG3,"-",xT3,xG1),-1),
    effsize.tabrow2(aaas_ag.out,paste(xT3,xG3,"-",xT4,xG1),-1),
    "\\parbox{11.5em}{\\hfil{}(idem)\\hfil{}}",
    effsize.tabrow2(aaas_ag.out,paste(xT3,xG3,"-",xT3,xG2),-1),
    effsize.tabrow2(aaas_ag.out,paste(xT3,xG3,"-",xT4,xG2),-1),
    "\\parbox{11.5em}{\\hfil{}(idem)\\hfil{}}",
    effsize.tabrow2(aaas_ag.out,paste(xT3,xG1,"-",xT3,xG2),-1),
    effsize.tabrow2(aaas_ag.out,paste(xT4,xG1,"-",xT4,xG2),-1)
  )

rathus.effsizes <-
  c(
    effsize.tabrow2(rathus.out,paste(xT1,xG1,"-",xT3,xG1),-1),
    effsize.tabrow2(rathus.out,paste(xT1,xG1,"-",xT4,xG1),-1),
    effsize.tabrow2(rathus.out,paste(xT3,xG1,"-",xT4,xG1),-1),
    effsize.tabrow2(rathus.out,paste(xT1,xG2,"-",xT3,xG2),-1),
    effsize.tabrow2(rathus.out,paste(xT1,xG2,"-",xT4,xG2),-1), 
    effsize.tabrow2(rathus.out,paste(xT3,xG2,"-",xT4,xG2),-1),
    effsize.tabrow2(rathus.out,paste(xT1,xG3,"-",xT3,xG3),-1),
    effsize.tabrow2(rathus.out,paste(xT3,xG3,"-",xT3,xG1),-1),
    effsize.tabrow2(rathus.out,paste(xT3,xG3,"-",xT4,xG1),-1),
    "\\parbox{11.5em}{\\hfil{}(idem)\\hfil{}}",
    effsize.tabrow2(rathus.out,paste(xT3,xG3,"-",xT3,xG2),-1),
    effsize.tabrow2(rathus.out,paste(xT3,xG3,"-",xT4,xG2),-1),
    "\\parbox{11.5em}{\\hfil{}(idem)\\hfil{}}",
    effsize.tabrow2(rathus.out,paste(xT3,xG1,"-",xT3,xG2),-1),
    effsize.tabrow2(rathus.out,paste(xT4,xG1,"-",xT4,xG2),-1)
  )

phq_sum.effsizes <-
  c(
    effsize.tabrow2(phq_sum.out,paste(xT1,xG1,"-",xT3,xG1),1),
    effsize.tabrow2(phq_sum.out,paste(xT1,xG1,"-",xT4,xG1),1),
    effsize.tabrow2(phq_sum.out,paste(xT3,xG1,"-",xT4,xG1),1),
    effsize.tabrow2(phq_sum.out,paste(xT1,xG2,"-",xT3,xG2),1),
    effsize.tabrow2(phq_sum.out,paste(xT1,xG2,"-",xT4,xG2),1),
    effsize.tabrow2(phq_sum.out,paste(xT3,xG2,"-",xT4,xG2),1),
    effsize.tabrow2(phq_sum.out,paste(xT1,xG3,"-",xT3,xG3),1),
    effsize.tabrow2(phq_sum.out,paste(xT3,xG3,"-",xT3,xG1),1),
    effsize.tabrow2(phq_sum.out,paste(xT3,xG3,"-",xT4,xG1),1),
    effsize.tabrow2(phq_sum.out,paste(xT1,xG3,"-",xT4,xG1),1), #levels(r2fu.long.data$time)[which.min(phq_sum.emm.plot$data$predicted[c(1,4,7)])]
    effsize.tabrow2(phq_sum.out,paste(xT3,xG3,"-",xT3,xG2),1),
    effsize.tabrow2(phq_sum.out,paste(xT3,xG3,"-",xT4,xG2),1),
    effsize.tabrow2(phq_sum.out,paste(xT1,xG3,"-",xT4,xG2),1), #levels(r2fu.long.data$time)[which.min(phq_sum.emm.plot$data$predicted[c(1,4,7)])]
    effsize.tabrow2(phq_sum.out,paste(xT3,xG1,"-",xT3,xG2),1),
    effsize.tabrow2(phq_sum.out,paste(xT4,xG1,"-",xT4,xG2),1)
  )

gad_sum.effsizes <-
  c(
    effsize.tabrow2(gad_sum.out,paste(xT1,xG1,"-",xT3,xG1),1),
    effsize.tabrow2(gad_sum.out,paste(xT1,xG1,"-",xT4,xG1),1),
    effsize.tabrow2(gad_sum.out,paste(xT3,xG1,"-",xT4,xG1),1),
    effsize.tabrow2(gad_sum.out,paste(xT1,xG2,"-",xT3,xG2),1),
    effsize.tabrow2(gad_sum.out,paste(xT1,xG2,"-",xT4,xG2),1),
    effsize.tabrow2(gad_sum.out,paste(xT3,xG2,"-",xT4,xG2),1),
    effsize.tabrow2(gad_sum.out,paste(xT1,xG3,"-",xT3,xG3),1),
    effsize.tabrow2(gad_sum.out,paste(xT3,xG3,"-",xT3,xG1),1),
    effsize.tabrow2(gad_sum.out,paste(xT3,xG3,"-",xT4,xG1),1),
    effsize.tabrow2(gad_sum.out,paste(xT2,xG3,"-",xT4,xG1),1), #levels(r2fu.long.data$time)[which.min(gad_sum.emm.plot$data$predicted[c(1,4,7)])]
    effsize.tabrow2(gad_sum.out,paste(xT3,xG3,"-",xT3,xG2),1),
    effsize.tabrow2(gad_sum.out,paste(xT3,xG3,"-",xT4,xG2),1),
    effsize.tabrow2(gad_sum.out,paste(xT2,xG3,"-",xT4,xG2),1), #levels(r2fu.long.data$time)[which.min(gad_sum.emm.plot$data$predicted[c(1,4,7)])]
    effsize.tabrow2(gad_sum.out,paste(xT3,xG1,"-",xT3,xG2),1),
    effsize.tabrow2(gad_sum.out,paste(xT4,xG1,"-",xT4,xG2),1)
  )

lsas_sum.effsizes <-
  c(
    effsize.tabrow2(lsas_sum.out,paste(xT1,xG1,"-",xT3,xG1),1),
    effsize.tabrow2(lsas_sum.out,paste(xT1,xG1,"-",xT4,xG1),1),
    effsize.tabrow2(lsas_sum.out,paste(xT3,xG1,"-",xT4,xG1),1),
    effsize.tabrow2(lsas_sum.out,paste(xT1,xG2,"-",xT3,xG2),1),
    effsize.tabrow2(lsas_sum.out,paste(xT1,xG2,"-",xT4,xG2),1),
    effsize.tabrow2(lsas_sum.out,paste(xT3,xG2,"-",xT4,xG2),1),
    effsize.tabrow2(lsas_sum.out,paste(xT1,xG3,"-",xT3,xG3),1),
    effsize.tabrow2(lsas_sum.out,paste(xT3,xG3,"-",xT3,xG1),1),
    effsize.tabrow2(lsas_sum.out,paste(xT3,xG3,"-",xT4,xG1),1),
    effsize.tabrow2(lsas_sum.out,paste(xT2,xG3,"-",xT4,xG1),1), #levels(r2fu.long.data$time)[which.min(lsas_sum.emm.plot$data$predicted[c(1,4,7)])]
    effsize.tabrow2(lsas_sum.out,paste(xT3,xG3,"-",xT3,xG2),1),
    effsize.tabrow2(lsas_sum.out,paste(xT3,xG3,"-",xT4,xG2),1),
    effsize.tabrow2(lsas_sum.out,paste(xT2,xG3,"-",xT4,xG2),1), #levels(r2fu.long.data$time)[which.min(lsas_sum.emm.plot$data$predicted[c(1,4,7)])]
    effsize.tabrow2(lsas_sum.out,paste(xT3,xG1,"-",xT3,xG2),1),
    effsize.tabrow2(lsas_sum.out,paste(xT4,xG1,"-",xT4,xG2),1)
  )

effectsize.table <- cbind.data.frame(
  comparison,
  aaas_ad.effsizes,
  aaas_ag.effsizes,
  rathus.effsizes,
  phq_sum.effsizes,
  gad_sum.effsizes,
  lsas_sum.effsizes
  )

measurementnamesspecial <- paste0("\\parbox{11.5em}{\\hfil{}",measurementnames,"\\hfil{}}")

colnames(effectsize.table) <- c(" ",measurementnamesspecial)

#saveRDS(effectsize.table,file="effectsize.table.RDS")

```

```{r effsizetab, echo = F, eval = T}

#effectsize.table <- readRDS("effectsize.table.RDS")

knitr::kable(
  effectsize.table,
  caption = "Within-group effect sizes [95\\% CI] comparing estimated marginal means between Pre- and Post-treatment, as well as between Pre-treatment and 1-year Follow-up, and between group effect sizes [95\\% CI] at Post-treatment and 1-year Follow-up.",
  align = "rllllll",
  escape = F,
  booktabs = T,
  format = "latex"
) %>%
  kable_styling(full_width = F, font_size = 7) %>%
  pack_rows("Within-group effect sizes", 1, 7, bold = F) %>%
  pack_rows("Between-group effect sizes", 8, 15, bold = F) %>%
  row_spec(c(3, 6, 7, 10, 13), extra_latex_after = "\\midrule") %>%
  column_spec(c(1), width = "24em") %>%
  column_spec(c(2:7), width = "11.5em") %>%
  add_header_above(
    c(
      " ",
      "Primary transdiagnostic measures of skillful behaviors" = 3,
      "Secondary measures of syndromal symptoms" = 3
    )
  ) %>%
  footnote(
    general = c(
      "CI = confidence interval",
      "AAA-S Adaptive = Adaptive and Aggressive Assertiveness Scales, Adaptive subscale; AAA-S Aggressive = Adaptive and Aggressive Assertiveness Scales, Aggressive Subscale, RAS = Rathus Assertiveness Schedule; PHQ-9 = Patient Health Questionnaire, 9 items; GAD-7 = Generalised Anxiety Disorder 7-item Scale; LSAS-SR = Liebowitz Social Anxiety Scale.",
      "Pre = pre-treatment measurement at 0 weeks; During = measurement during week 4; Post = measurement after completion of treatment at week 8; Follow-up = measurement at 1 year after completion.",
      "\\\\textsuperscript{\\\\dag} = the most conservative measurement for the Waitlist control condition, in order to suppress any nocebo effects; see dotted lines in graphs in Figure 3 for identification of time point.",
      "\\\\textsuperscript{*} = \\\\textit{p} < .05, \\\\textsuperscript{**} = \\\\textit{p} < .01, \\\\textsuperscript{***} = \\\\textit{p} < .00; \\\\textit{p}-values are Bonferroni adjusted, based on pairwise comparisons of all sampled time points and conditions."
    ),
    escape = F,
    general_title = "Notes.",
    footnote_as_chunk = F,
    threeparttable = T
  ) %>%
  kableExtra::landscape()

```

```{r clinsig, echo = F, eval = T, results='hide'}

# Intention-to-treat data frame
r2fu.itt.data <- r2fu.long.data

# Group keys
ig1 <- grepl(xG1, r2fu.itt.data$group)
ig2 <- grepl(xG2, r2fu.itt.data$group)
ig3 <- grepl(xG3, r2fu.itt.data$group)

# Time keys
it1 <- grepl(xT1, r2fu.itt.data$time)
it2 <- grepl(xT2, r2fu.itt.data$time)
it3 <- grepl(xT3, r2fu.itt.data$time)
it4 <- grepl(xT4, r2fu.itt.data$time)

# Copy values over to empty future time points, starting with Pre --> During and moving forward
# Last observation carried forward
for (xmeasure in measurementshortnames) {
  copyvalues <-
    which(is.na(r2fu.itt.data[it2, xmeasure])) # Pre --> During
  r2fu.itt.data[it2, xmeasure][copyvalues] <-
    r2fu.itt.data[it1, xmeasure][copyvalues]
  copyvalues <-
    which(is.na(r2fu.itt.data[it3, xmeasure])) # During --> Post
  r2fu.itt.data[it3, xmeasure][copyvalues] <-
    r2fu.itt.data[it2, xmeasure][copyvalues]
  copyvalues <-
    which(is.na(r2fu.itt.data[it4, xmeasure])) # Post --> Follow-up
  r2fu.itt.data[it4, xmeasure][copyvalues] <-
    r2fu.itt.data[it3, xmeasure][copyvalues]
}

# Clinical significant change data.frame output
clinsigraw <- function(measure, direction, first, last, group) {
  groupkey <- grepl(group, r2fu.itt.data$group)
  clinsig <- clinical_significance(
    data = r2fu.itt.data[groupkey, ],
    better_is = direction,
    id = subject,
    time = time,
    outcome = measure,
    pre = first,
    post = last,
    reliability = norms[which(measurementshortnames == measure), 1],
    m_functional = norms[which(measurementshortnames == measure), 2],
    sd_functional = norms[which(measurementshortnames == measure), 3],
    type = "c"
  )
  recovered <- clinsig$categories$recovered
  worsened <- clinsig$categories$harmed + clinsig$categories$deteriorated
  return(
    list(
      recovered = as.numeric(recovered),
      harmed = as.numeric(clinsig$categories$harmed),
      deteriorated = as.numeric(clinsig$categories$deteriorated),
      worsened = as.numeric(worsened)
    )
  )
}

## Test statistical significance of clinical significant change Pre --> Post

aaas_ad.pre.post.kw <- dunn.test(list(
  clinsigraw("aaas_ad", "higher", xT1, xT3, xG3)$recovered,
  clinsigraw("aaas_ad", "higher", xT1, xT3, xG1)$recovered,
  clinsigraw("aaas_ad", "higher", xT1, xT3, xG2)$recovered
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 7.9198, df = 2, p-value = 0.02, calls for pairwise comparisons
# $altP.adjusted
# [1] 0.03801518 0.05187877 1.00000000

# aaas_ad.pre.post.kw.worsened <- dunn.test(list(
#   clinsigraw("aaas_ad", "higher", xT1, xT3, xG3)$worsened,
#   clinsigraw("aaas_ad", "higher", xT1, xT3, xG1)$worsened,
#   clinsigraw("aaas_ad", "higher", xT1, xT3, xG2)$worsened
# ), method="bonferroni", altp=TRUE)
# No worsening in any group, nothing to test!

aaas_ag.pre.post.kw <- dunn.test(list(
  clinsigraw("aaas_ag", "higher", xT1, xT3, xG3)$recovered,
  clinsigraw("aaas_ag", "higher", xT1, xT3, xG1)$recovered,
  clinsigraw("aaas_ag", "higher", xT1, xT3, xG2)$recovered
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 0.1847, df = 2, p-value = 0.91

aaas_ag.pre.post.kw.harmed <- dunn.test(list(
  clinsigraw("aaas_ag", "higher", xT1, xT3, xG3)$harmed,
  clinsigraw("aaas_ag", "higher", xT1, xT3, xG1)$harmed,
  clinsigraw("aaas_ag", "higher", xT1, xT3, xG2)$harmed
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 6.104, df = 2, p-value = 0.05, calls for pairwise comparisons
# $altP.adjusted
# [1] 0.09974166 0.09408707 1.00000000; no difference found

aaas_ag.pre.post.kw.worsened <- dunn.test(list(
  clinsigraw("aaas_ag", "higher", xT1, xT3, xG3)$worsened,
  clinsigraw("aaas_ag", "higher", xT1, xT3, xG1)$worsened,
  clinsigraw("aaas_ag", "higher", xT1, xT3, xG2)$worsened
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 3.1136, df = 2, p-value = 0.21

rathus.pre.post.kw <- dunn.test(list(
  clinsigraw("rathus", "higher", xT1, xT3, xG3)$recovered,
  clinsigraw("rathus", "higher", xT1, xT3, xG1)$recovered,
  clinsigraw("rathus", "higher", xT1, xT3, xG2)$recovered
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 14.9234, df = 2, p-value = 0, calls for pairwise comparisons
# $altP.adjusted
# [1] 0.006524832 0.001064018 1.000000000; differences found

# rathus.pre.post.kw.worsened <- dunn.test(list(
#   clinsigraw("rathus", "higher", xT1, xT3, xG3)$worsened,
#   clinsigraw("rathus", "higher", xT1, xT3, xG1)$worsened,
#   clinsigraw("rathus", "higher", xT1, xT3, xG2)$worsened
# ), method="bonferroni", altp=TRUE)
# No worsening in any group, nothing to test!

phq_sum.pre.post.kw <- dunn.test(list(
  clinsigraw("phq_sum", "lower", xT1, xT3, xG3)$recovered,
  clinsigraw("phq_sum", "lower", xT1, xT3, xG1)$recovered,
  clinsigraw("phq_sum", "lower", xT1, xT3, xG2)$recovered
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 9.6651, df = 2, p-value = 0.01, calls for pairwise comparisons
# $altP.adjusted
# [1] 0.241241515 0.005787945 0.552125729; differences found

phq_sum.pre.post.kw.harmed <- dunn.test(list(
  clinsigraw("phq_sum", "lower", xT1, xT3, xG3)$harmed,
  clinsigraw("phq_sum", "lower", xT1, xT3, xG1)$harmed,
  clinsigraw("phq_sum", "lower", xT1, xT3, xG2)$harmed
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 0.9316, df = 2, p-value = 0.63

phq_sum.pre.post.kw.worsened <- dunn.test(list(
  clinsigraw("phq_sum", "lower", xT1, xT3, xG3)$worsened,
  clinsigraw("phq_sum", "lower", xT1, xT3, xG1)$worsened,
  clinsigraw("phq_sum", "lower", xT1, xT3, xG2)$worsened
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 5.0582, df = 2, p-value = 0.08

gad_sum.pre.post.kw <- dunn.test(list(
  clinsigraw("gad_sum", "lower", xT1, xT3, xG3)$recovered,
  clinsigraw("gad_sum", "lower", xT1, xT3, xG1)$recovered,
  clinsigraw("gad_sum", "lower", xT1, xT3, xG2)$recovered
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 2.0239, df = 2, p-value = 0.36

gad_sum.pre.post.kw.harmed <- dunn.test(list(
  clinsigraw("gad_sum", "lower", xT1, xT3, xG3)$harmed,
  clinsigraw("gad_sum", "lower", xT1, xT3, xG1)$harmed,
  clinsigraw("gad_sum", "lower", xT1, xT3, xG2)$harmed
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 2.9776, df = 2, p-value = 0.23

gad_sum.pre.post.kw.worsened <- dunn.test(list(
  clinsigraw("gad_sum", "lower", xT1, xT3, xG3)$worsened,
  clinsigraw("gad_sum", "lower", xT1, xT3, xG1)$worsened,
  clinsigraw("gad_sum", "lower", xT1, xT3, xG2)$worsened
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 5.8257, df = 2, p-value = 0.05, calls for pairwise comparisons
# $altP.adjusted
# [1] 0.96895090 0.04909457 0.48795293; differences found

lsas_sum.pre.post.kw <- dunn.test(list(
  clinsigraw("lsas_sum", "lower", xT1, xT3, xG3)$recovered,
  clinsigraw("lsas_sum", "lower", xT1, xT3, xG1)$recovered,
  clinsigraw("lsas_sum", "lower", xT1, xT3, xG2)$recovered
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 7.5439, df = 2, p-value = 0.02, calls for pairwise comparisons
# $altP.adjusted
# [1] 0.04540113 0.05980064 1.00000000

lsas_sum.pre.post.kw.harmed <- dunn.test(list(
  clinsigraw("lsas_sum", "lower", xT1, xT3, xG3)$harmed,
  clinsigraw("lsas_sum", "lower", xT1, xT3, xG1)$harmed,
  clinsigraw("lsas_sum", "lower", xT1, xT3, xG2)$harmed
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 2.0597, df = 2, p-value = 0.36

lsas_sum.pre.post.kw.worsened <- dunn.test(list(
  clinsigraw("lsas_sum", "lower", xT1, xT3, xG3)$worsened,
  clinsigraw("lsas_sum", "lower", xT1, xT3, xG1)$worsened,
  clinsigraw("lsas_sum", "lower", xT1, xT3, xG2)$worsened
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 9.1314, df = 2, p-value = 0.01, calls for pairwise comparisons
# $altP.adjusted
# [1] 0.11608446 0.00972895 1.00000000; differences found

## Test statistical significance of clinical significant change Pre --> Follow-up

aaas_ad.pre.fu.kw <- dunn.test(list(
  clinsigraw("aaas_ad", "higher", xT1, xT4, xG3)$recovered,
  clinsigraw("aaas_ad", "higher", xT1, xT4, xG1)$recovered,
  clinsigraw("aaas_ad", "higher", xT1, xT4, xG2)$recovered
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 12.3534, df = 2, p-value = 0, calls for pairwise comparisons
# $altP.adjusted
# [1] 0.01854809 0.00311267 1.00000000; differences found

# aaas_ad.pre.fu.kw.worsened <- dunn.test(list(
#   clinsigraw("aaas_ad", "higher", xT1, xT4, xG3)$worsened,
#   clinsigraw("aaas_ad", "higher", xT1, xT4, xG1)$worsened,
#   clinsigraw("aaas_ad", "higher", xT1, xT4, xG2)$worsened
# ), method="bonferroni", altp=TRUE)
# No worsening in any group, nothing to test!

aaas_ag.pre.fu.kw <- dunn.test(list(
  clinsigraw("aaas_ag", "higher", xT1, xT4, xG3)$recovered,
  clinsigraw("aaas_ag", "higher", xT1, xT4, xG1)$recovered,
  clinsigraw("aaas_ag", "higher", xT1, xT4, xG2)$recovered
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 1.7287, df = 2, p-value = 0.42

aaas_ag.pre.fu.kw.harmed <- dunn.test(list(
  clinsigraw("aaas_ag", "higher", xT1, xT4, xG3)$harmed,
  clinsigraw("aaas_ag", "higher", xT1, xT4, xG1)$harmed,
  clinsigraw("aaas_ag", "higher", xT1, xT4, xG2)$harmed
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 3.5677, df = 2, p-value = 0.17

aaas_ag.pre.fu.kw.worsened <- dunn.test(list(
  clinsigraw("aaas_ag", "higher", xT1, xT4, xG3)$worsened,
  clinsigraw("aaas_ag", "higher", xT1, xT4, xG1)$worsened,
  clinsigraw("aaas_ag", "higher", xT1, xT4, xG2)$worsened
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 4.0919, df = 2, p-value = 0.13

rathus.pre.fu.kw <- dunn.test(list(
  clinsigraw("rathus", "higher", xT1, xT4, xG3)$recovered,
  clinsigraw("rathus", "higher", xT1, xT4, xG1)$recovered,
  clinsigraw("rathus", "higher", xT1, xT4, xG2)$recovered
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 21.5053, df = 2, p-value = 0, calls for pairwise comparisons
# $altP.adjusted
# [1] 7.582296e-04 5.122463e-05 1.000000e+00; differences found

# rathus.pre.fu.kw.worsened <- dunn.test(list(
#   clinsigraw("rathus", "higher", xT1, xT4, xG3)$worsened,
#   clinsigraw("rathus", "higher", xT1, xT4, xG1)$worsened,
#   clinsigraw("rathus", "higher", xT1, xT4, xG2)$worsened
# ), method="bonferroni", altp=TRUE)
# No worsening in any group, nothing to test!

phq_sum.pre.fu.kw <- dunn.test(list(
  clinsigraw("phq_sum", "lower", xT1, xT4, xG3)$recovered,
  clinsigraw("phq_sum", "lower", xT1, xT4, xG1)$recovered,
  clinsigraw("phq_sum", "lower", xT1, xT4, xG2)$recovered
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 11.8735, df = 2, p-value = 0, calls for pairwise comparisons
# $altP.adjusted
# [1] 0.16571305 0.00175382 0.40476336; differences found

phq_sum.pre.fu.kw.harmed <- dunn.test(list(
  clinsigraw("phq_sum", "lower", xT1, xT4, xG3)$harmed,
  clinsigraw("phq_sum", "lower", xT1, xT4, xG1)$harmed,
  clinsigraw("phq_sum", "lower", xT1, xT4, xG2)$harmed
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 1.2129, df = 2, p-value = 0.55

phq_sum.pre.fu.kw.worsened <- dunn.test(list(
  clinsigraw("phq_sum", "lower", xT1, xT4, xG3)$worsened,
  clinsigraw("phq_sum", "lower", xT1, xT4, xG1)$worsened,
  clinsigraw("phq_sum", "lower", xT1, xT4, xG2)$worsened
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 7.8589, df = 2, p-value = 0.02, calls for pairwise comparisons
# $altP.adjusted
# [1] 0.01522904 0.41861314 0.53078210; differences found

gad_sum.pre.fu.kw <- dunn.test(list(
  clinsigraw("gad_sum", "lower", xT1, xT4, xG3)$recovered,
  clinsigraw("gad_sum", "lower", xT1, xT4, xG1)$recovered,
  clinsigraw("gad_sum", "lower", xT1, xT4, xG2)$recovered
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 5.123, df = 2, p-value = 0.08

gad_sum.pre.fu.kw.harmed <- dunn.test(list(
  clinsigraw("gad_sum", "lower", xT1, xT4, xG3)$harmed,
  clinsigraw("gad_sum", "lower", xT1, xT4, xG1)$harmed,
  clinsigraw("gad_sum", "lower", xT1, xT4, xG2)$harmed
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 2.1993, df = 2, p-value = 0.33

gad_sum.pre.fu.kw.worsened <- dunn.test(list(
  clinsigraw("gad_sum", "lower", xT1, xT4, xG3)$worsened,
  clinsigraw("gad_sum", "lower", xT1, xT4, xG1)$worsened,
  clinsigraw("gad_sum", "lower", xT1, xT4, xG2)$worsened
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 2.5818, df = 2, p-value = 0.28

lsas_sum.pre.fu.kw <- dunn.test(list(
  clinsigraw("lsas_sum", "lower", xT1, xT4, xG3)$recovered,
  clinsigraw("lsas_sum", "lower", xT1, xT4, xG1)$recovered,
  clinsigraw("lsas_sum", "lower", xT1, xT4, xG2)$recovered
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 14.1971, df = 2, p-value = 0, calls for pairwise comparisons
# $altP.adjusted
# [1] 0.015456411 0.001003215 1.000000000; differences found

lsas_sum.pre.fu.kw.harmed <- dunn.test(list(
  clinsigraw("lsas_sum", "lower", xT1, xT4, xG3)$harmed,
  clinsigraw("lsas_sum", "lower", xT1, xT4, xG1)$harmed,
  clinsigraw("lsas_sum", "lower", xT1, xT4, xG2)$harmed
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 2.0156, df = 2, p-value = 0.37

lsas_sum.pre.fu.kw.worsened <- dunn.test(list(
  clinsigraw("lsas_sum", "lower", xT1, xT4, xG3)$worsened,
  clinsigraw("lsas_sum", "lower", xT1, xT4, xG1)$worsened,
  clinsigraw("lsas_sum", "lower", xT1, xT4, xG2)$worsened
), method="bonferroni", altp=TRUE)
# Kruskal-Wallis chi-squared = 8.4085, df = 2, p-value = 0.01, calls for pairwise comparisons
# $altP.adjusted
# [1] 0.03836684 0.03371498 1.00000000; differences found

```

```{r buildclinsigtab, echo = F, eval = T}

# Clinical significant change table output
clinsig <- function(measure, direction, first, last, group, kwobj) {
  groupkey <- grepl(group, r2fu.itt.data$group)
  kwstars <-
    if (group == xG1) {
      xpss(kwobj$altP.adjusted[1])
    } else if (group == xG2) {
      xpss(kwobj$altP.adjusted[2])
    } else { NULL }
  clinsig <- clinical_significance(
    data = r2fu.itt.data[groupkey, ],
    better_is = direction,
    id = subject,
    time = time,
    outcome = measure,
    pre = first,
    post = last,
    reliability = norms[which(measurementshortnames == measure), 1],
    m_functional = norms[which(measurementshortnames == measure), 2],
    sd_functional = norms[which(measurementshortnames == measure), 3],
    type = "c"
  )
  output <- as.matrix(clinsig$summary[c(2:3)])
    output <-
    paste0(
      "\\parbox[b]{3.12em}{\\flushright$",
      output[, 1],
      "$} ($",
      round(output[, 2] * 100),
      "$\\%)"
    )
  output <- c(paste0(output[1],kwstars), output[c(2:5)])
  return(output)
}

clinsigtext <- function(measure, direction, first, last, group, kwobj) {
  groupkey <- grepl(group, r2fu.itt.data$group)
  row <-
    if (group == xG1) { 1 } else if (group == xG2) { 2 } else { NULL }
  df <- length(kwobj$Z) -1
  kwstars <- paste0(
    "$Z$(",
    df,
    ") = ",
    xresult(kwobj$Z[row],2),
    ", ",
    xpr(kwobj$altP.adjusted[row],a="Bonf")
  ) 
  clinsig <- clinical_significance(
    data = r2fu.itt.data[groupkey, ],
    better_is = direction,
    id = subject,
    time = time,
    outcome = measure,
    pre = first,
    post = last,
    reliability = norms[which(measurementshortnames == measure), 1],
    m_functional = norms[which(measurementshortnames == measure), 2],
    sd_functional = norms[which(measurementshortnames == measure), 3],
    type = "c"
  )
  output <- as.matrix(clinsig$summary[c(2:3)])
  output <-
    paste0(
      "$n$ = $",
      output[, 1],
      "$ ($",
      round(output[, 2] * 100),
      "$\\%)"
    )
  output <- c(paste0(output[1], ", ", kwstars), output[c(2:5)])
  return(output)
}
  
xclinsigcategories <- c("Recovered", "Improved", "Unchanged", "Deteriorated", "Harmed")

clinsig.table <- rbind(
  cbind(
    xclinsigcategories,
    clinsig("aaas_ad", "higher", xT1, xT3, xG3, aaas_ad.pre.post.kw),
    clinsig("aaas_ad", "higher", xT1, xT3, xG1, aaas_ad.pre.post.kw),
    clinsig("aaas_ad", "higher", xT1, xT4, xG1, aaas_ad.pre.fu.kw),
    clinsig("aaas_ad", "higher", xT1, xT3, xG2, aaas_ad.pre.post.kw),
    clinsig("aaas_ad", "higher", xT1, xT4, xG2, aaas_ad.pre.fu.kw)
  ),
  cbind(
    xclinsigcategories,
    clinsig("aaas_ag", "higher", xT1, xT3, xG3, aaas_ag.pre.post.kw),
    clinsig("aaas_ag", "higher", xT1, xT3, xG1, aaas_ag.pre.post.kw),
    clinsig("aaas_ag", "higher", xT1, xT4, xG1, aaas_ag.pre.fu.kw),
    clinsig("aaas_ag", "higher", xT1, xT3, xG2, aaas_ag.pre.post.kw),
    clinsig("aaas_ag", "higher", xT1, xT4, xG2, aaas_ag.pre.fu.kw)
  ),
  cbind(
    xclinsigcategories,
    clinsig("rathus", "higher", xT1, xT3, xG3, rathus.pre.post.kw),
    clinsig("rathus", "higher", xT1, xT3, xG1, rathus.pre.post.kw),
    clinsig("rathus", "higher", xT1, xT4, xG1, rathus.pre.fu.kw),
    clinsig("rathus", "higher", xT1, xT3, xG2, rathus.pre.post.kw),
    clinsig("rathus", "higher", xT1, xT4, xG2, rathus.pre.fu.kw)
  ),
  cbind(
    xclinsigcategories,
    clinsig("phq_sum", "lower", xT1, xT3, xG3, phq_sum.pre.post.kw),
    clinsig("phq_sum", "lower", xT1, xT3, xG1, phq_sum.pre.post.kw),
    clinsig("phq_sum", "lower", xT1, xT4, xG1, phq_sum.pre.fu.kw),
    clinsig("phq_sum", "lower", xT1, xT3, xG2, phq_sum.pre.post.kw),
    clinsig("phq_sum", "lower", xT1, xT4, xG2, phq_sum.pre.fu.kw)
  ),
  cbind(
    xclinsigcategories,
    clinsig("gad_sum", "lower", xT1, xT3, xG3, gad_sum.pre.post.kw),
    clinsig("gad_sum", "lower", xT1, xT3, xG1, gad_sum.pre.post.kw),
    clinsig("gad_sum", "lower", xT1, xT4, xG1, gad_sum.pre.fu.kw),
    clinsig("gad_sum", "lower", xT1, xT3, xG2, gad_sum.pre.post.kw),
    clinsig("gad_sum", "lower", xT1, xT4, xG2, gad_sum.pre.fu.kw)
  ),
  cbind(
    xclinsigcategories,
    clinsig("lsas_sum", "lower", xT1, xT3, xG3, lsas_sum.pre.post.kw),
    clinsig("lsas_sum", "lower", xT1, xT3, xG1, lsas_sum.pre.post.kw),
    clinsig("lsas_sum", "lower", xT1, xT4, xG1, lsas_sum.pre.fu.kw),
    clinsig("lsas_sum", "lower", xT1, xT3, xG2, lsas_sum.pre.post.kw),
    clinsig("lsas_sum", "lower", xT1, xT4, xG2, lsas_sum.pre.fu.kw)
  )
)

# xcolnames <-
#   c(
#     " ",
#     paste(xG3, xT3),
#     paste(xG1, xT3),
#     paste(xG1, xT4),
#     paste(xG2, xT3),
#     paste(xG2, xT4)
#   )

# xcolnames <-
#   c(
#     " ",
#     paste0(xT1,"--",xT3),
#     paste0(xT1,"--",xT3),
#     paste0(xT1,"--",xT4),
#     paste0(xT1,"--",xT3),
#     paste0(xT1,"--",xT4)
#   )

xcolnames <-
  c(
    " ",
    paste0("\\parbox{8em}{\\hfil{}",xT1,"--",xT3,"\\hfil{}}"),
    paste0("\\parbox{8em}{\\hfil{}",xT1,"--",xT3,"\\hfil{}}"),
    paste0("\\parbox{8em}{\\hfil{}",xT1,"--",xT4,"\\hfil{}}"),
    paste0("\\parbox{8em}{\\hfil{}",xT1,"--",xT3,"\\hfil{}}"),
    paste0("\\parbox{8em}{\\hfil{}",xT1,"--",xT4,"\\hfil{}}")
  )

colnames(clinsig.table) <- xcolnames

```

```{r clinsigtab, echo = F, eval = T, results = 'asis'}

knitr::kable(clinsig.table, caption="Clinical significance summary of the number (and proportion in \\%) of participants that changed reliably and moved from the clinical to the functional population from Pre-treatment to Post- and 1-year Followup-time-points respectively (rows named 'Recovered'). For missing values (i.e. caused by drop-outs), the last collected value was moved forward to the next measurement time point, in order to respect the intention to treat principle.", booktabs = T, format = "latex", align="rlllll", escape = F) %>%
  kable_styling(full_width = F, font_size = 10) %>%
  pack_rows(paste0(measurementnames[1]), 1, 5, bold = F, escape = F) %>%
  pack_rows(paste0(measurementnames[2]), 6, 10, bold = F, escape = F) %>%
  pack_rows(paste0(measurementnames[3]), 11, 15, bold = F, escape = F) %>%
  pack_rows(paste0(measurementnames[4]), 16, 20, bold = F, escape = F) %>%
  pack_rows(paste0(measurementnames[5]), 21, 25, bold = F, escape = F) %>%
  pack_rows(paste0(measurementnames[6]), 26, 30, bold = F, escape = F) %>%
  row_spec(c(5,10,15,20,25), extra_latex_after = "\\midrule") %>%
  column_spec(c(1), width = "7em") %>%
  column_spec(c(2:6), width = "8em") %>%
  add_header_above(c(" ", "Waitlist" = 1, "Self-help" = 2, "Guided" = 2)) %>%
  footnote(
    general = c(
      "AAA-S Adaptive = Adaptive and Aggressive Assertiveness Scales, Adaptive subscale; AAA-S Aggressive = Adaptive and Aggressive Assertiveness Scales, Aggressive Subscale, RAS = Rathus Assertiveness Schedule; PHQ-9 = Patient Health Questionnaire, 9 items; GAD-7 = Generalised Anxiety Disorder 7-item Scale; LSAS-SR = Liebowitz Social Anxiety Scale.",
      "\\\\textsuperscript{*} = \\\\textit{p} < .05, \\\\textsuperscript{**} = \\\\textit{p} < .01, \\\\textsuperscript{***} = \\\\textit{p} < .00; \\\\textit{p}-values are Bonferroni adjusted."
      ),
    escape = F,
    general_title = "Notes.",
    footnote_as_chunk = F,
    threeparttable = T
  )

```

## Treatment efficacy, primary and secondary measures

Mixed models including groups Unguided self-help, Guided self-help, and Waitlist at time-points Pre, During and Post revealed time \texttimes{} group interaction effects for all three measures of assertiveness: The Adaptive subscale of AAA-S, `r report.anova(aaas_ad.post.anova)[3]`, the Aggressive subscale of AAA-S, `r report.anova(aaas_ag.post.anova)[3]`, and the RAS, `r report.anova(rathus.post.anova)[3]`. These interactions show that the random assignment to group conditions did have an effect over time on assertive behaviors. Similarily, mixed models for the syndromal symptoms revealed time \texttimes{} group interaction effects for all three measures of anxiety and depression: PHQ-9, `r report.anova(phq_sum.post.anova)[3]`, GAD-7, `r report.anova(gad_sum.post.anova)[3]`, and LSAS-SR, `r report.anova(lsas_sum.post.anova)[3]`. Estimated mean levels of depressive mood and generalized and social anxiety symptoms were significantly affected by participation in the intervention.

### Between-group effects on assertive behaviors

Post-hoc testing of marginal mean differences in pairwise comparisons between all groups and time-points revealed significant effects between both treatment groups and the Waitlist group for all three primary measures of assertiveness at Post, that is at the end of the 8-week Respekt^2^ treatment program. It also revealed signigificant effects at Follow-up, that is 1 year after end of treatment, comparing against the Post time-point for the Waitlist condition. Table 2 summarizes significance tests of estimated marginal mean differences and effect sizes, including 95\% confidence intervals (CI).

```{r displaytoggle}

stats <- factor(c("sigshort","sig","delta","effshort","eff","sigeffshort","allshort","all"))

display = stats[7]

```

Comparing against Waitlist, the effect of the Unguided self-help condition on adaptive assertiveness using the AAA-S Adaptive primary measure was large at Post-treatment, `r report.text2(aaas_ad.out, paste(xT3,xG3,"-",xT3,xG1), -1, display)`, and even larger at 1-year Follow-up, `r report.text2(aaas_ad.out, paste(xT3,xG3,"-",xT4,xG1), -1, display)`. Large effects at Post were found also for aggressive assertiveness as measured with AAA-S Aggressive, `r report.text2(aaas_ag.out, paste(xT3,xG3,"-",xT3,xG1), -1, display)`, and at Follow-up,  `r report.text2(aaas_ag.out, paste(xT3,xG3,"-",xT4,xG1), -1, display)`, as well as for 'compound' assertiveness assessed with the RAS, `r report.text2(rathus.out, paste(xT3,xG3,"-",xT3,xG1), -1, display)`, and at Follow-up, `r report.text2(rathus.out, paste(xT3,xG3,"-",xT4,xG1), -1, display)`. 

Similarily, the effect of the Guided self-help condition on AAA-S Adaptive was large at Post-treatment, `r report.text2(aaas_ad.out, paste(xT3,xG3,"-",xT3,xG2), -1, display)`, at 1-year Follow-up having grown to `r report.text2(aaas_ad.out, paste(xT3,xG3,"-",xT4,xG2), -1, display)`. Large effects at Post were identified for AAA-S Aggressive, `r report.text2(aaas_ag.out, paste(xT3,xG3,"-",xT3,xG2), -1, display)`, and at Follow-up,  `r report.text2(aaas_ag.out, paste(xT3,xG3,"-",xT4,xG2), -1, display)`, as well as for the RAS measure `r report.text2(rathus.out, paste(xT3,xG3,"-",xT3,xG2), -1, display)` at Post, and `r report.text2(rathus.out, paste(xT3,xG3,"-",xT4,xG2), -1, display)` at Follow-up. 

Comparing the Unguided self-help and the Guided self-help treatment conditions, there was no significant difference neither at Post nor at Follow-up, revealing that participants working through the intervention on their own fared just as well as those who were supported by a therapist.

### Between-group effects on syndromal symptoms of anxiety and depression

In post-hoc testing, no effect on alleviation of depressive symptoms measured with PHQ-9 at the Post time-point was found comparing the Waitlist and the Unguided self-help groups. Tentative evidence was found for support by therapists benefiting depressed participants, in that the Waitlist versus Guided self-help comparison for PHQ-9 revealed a moderate to large sized effect at Post, `r report.text2(phq_sum.out, paste(xT3,xG3,"-",xT3,xG2), 1, display)`. However, this effect dissipated when the Follow-up comparison was instead made against the most conservative value collected in the Waitlist group, in this case from the Pre time-point; see Figure 3 for a visual exploration of a possible nocebo effect, that is symptomatic worsening over time due to self-fulfilling expectations of low mood among participants waiting in line for treatment.

No between-group effects were found for GAD-7, comparing treatment groups against Waitlist. Also, there was no significant effect of the Unguided self-help condition on reduction of social anxiety symptoms measured with LSAS-SR at Post-treatment. 
<!-- `r xprnot(lsas_sum.out$emmpairs$p.value[22])`,  -->
However, a large effect was found at Follow-up, `r report.text2(lsas_sum.out, paste(xT2,xG3,"-",xT4,xG1), 1, display)` for the Unguided self-help group, comparing against the lowest value collected, that is at During, half-way through the intervention; see Figure 3 for identification of time point. For the Guided self-help group, a moderate effect was found at Post, `r report.text2(lsas_sum.out, paste(xT1,xG3,"-",xT3,xG2), 1, display)`, as well as Follow-up, `r report.text2(lsas_sum.out, paste(xT2,xG3,"-",xT4,xG2), 1, display)`, comparing against the most conservative time-point, at During, for the Waitlist.

Thus, the 8-week Respekt^2^ intervention had no effect on either depression or generalized anxiety. However, it did have a pronounced effect on social anxiety. See table 2 for a summary of significant effects, including 95\% CIs.

### Notable within-group effects

As shown in table 2, participants in both treatment groups enjoyed sustained within-group effects on assertiveness at 1 year Follow-up when compared to the Pre-treatment measurement time point, measured with AAA-S Adaptive, AAA-S Aggressive and the RAS, revealing that assertive behaviors were still manifest well beyond the end of participation in the intervention. However, significant effects between the Post to Follow-up time-points were found only for two measures in the Guided self-help group, where AAA-S Adaptive and the RAS exhibited small to medium effects, `r report.text2(aaas_ad.out, paste(xT3,xG2,"-",xT4,xG2), -1)` and `r report.text2(rathus.out, paste(xT3,xG2,"-",xT4,xG2), -1)` respectively. In the Unguided self-help group, there was no difference between Post and Follow-up time points for either measure, `r xprnot(aaas_ad.out$emmpairs$p.value[41])` and `r xprnot(rathus.out$emmpairs$p.value[41])`, evidencing that therapist support provided some benefit to participants' ability to generalize adaptive assertive behaviors beyond the duration of the intervention.

Among the secondary measures of syndromal symptoms, depression as captured with PHQ-9 had decreased significantly from Pre only in the Guided self-help group, and only at Follow-up, showing a medium effect, `r report.text2(phq_sum.out, paste(xT1,xG2,"-",xT4,xG2), 1)`, implying that therapist support benefited depressed participants on a longer rather than shorter time scale. 

<!-- Following up on the significant time \texttimes{} group interactions found for all three primary and all three secondary measures of skillful behaviors, post-hoc testing revealed that participants in both treatment groups Unguided self-help and Guided self-help improved significantly during the course of the intervention, and that effects were sustained or improved at 1-year Follow-up. Table 2 summarizes significance tests of estimated marginal mean differences and effect sizes, including 95\% confidence intervals. -->

<!-- #### Primary measures Pre to Post, and Pre to Follow-up -->

<!-- With regards to assertive behaviors, both the Unguided self-help and Guided self-help improved significantly during the course of the intervention, showing large within-group effects with regards to AAA-S Adaptive from Pre to Post, `r report.text2(aaas_ad.out, paste(xT1,xG1,"-",xT3,xG1), -1)`, and `r report.text2(aaas_ad.out, paste(xT1,xG2,"-",xT3,xG2), -1)` respectively. For the AAA-S Agressive, small to medium effects were observed in the Unguided self-help group, `r report.text2(aaas_ag.out, paste(xT1,xG1,"-",xT3,xG1), -1)`, and the Guided self-help group, `r report.text2(aaas_ag.out, paste(xT1,xG2,"-",xT3,xG2), -1)`, suggesting that participants somewhat increased their levels of assertions that they themselves deemed aggressive. Confirming these trends, large effects on assertiveness from Pre to Post were also found for the RAS in both the Unguided self-help group, `r report.text2(rathus.out, paste(xT1,xG1,"-",xT3,xG1), -1)`, and the Guided self-help group, `r report.text2(rathus.out, paste(xT1,xG2,"-",xT3,xG2), -1)`. Both treatment groups showed sustained within-group effects on assertiveness at 1 year Follow-up when compared to the Pre-treatment measurement time point, measured with AAA-S Adaptive, AAA-S Aggressive and the RAS, suggesting that assertive behaviors were still manifest well beyond the end of participation in the intervention. However, significant effects between the Post to Follow-up time-points were found only in the Guided self-help, where AAA-S Adaptive and the RAS exhibited small to medium effects, `r report.text2(aaas_ad.out, paste(xT3,xG2,"-",xT4,xG2), -1)` and `r report.text2(rathus.out, paste(xT3,xG2,"-",xT4,xG2), -1)` respectively. In the Unguided self-help group, there was no difference between Post and Follow-up time points for either measure, from `r xprnot(rathus.out$emmpairs$p.value[41])` to `r xprnot(aaas_ag.out$emmpairs$p.value[55])`. This indicates that therapist support might have provided some benefit to participants' ability to generalize adaptive behaviors beyond the duration of the intervention. -->

<!-- #### Secondary measures Pre to Post, and Pre to Follow-up -->

<!-- Among the secondary measures of syndromal symptoms, depression as captured with PHQ-9 had decreased significantly from Pre only in the Guided self-help group, and only at Follow-up, showing a medium effect, `r report.text2(phq_sum.out, paste(xT1,xG2,"-",xT4,xG2), 1)`, possibly indicating that therapist support benefits depressed participants on a longer rather than shorter time scale. Symptoms of generalized anxiety, however, decreased significantly for all combinations of time points and groups. In the Unguided self-help group, the effect from Pre to Post was `r report.text2(gad_sum.out, paste(xT1,xG1,"-",xT3,xG1), 1)`, increasing to `r report.text2(gad_sum.out, paste(xT1,xG1,"-",xT4,xG1), 1)` Pre to Follow-up. In the Guided self-help group, the effect from Pre to Post was `r report.text2(gad_sum.out, paste(xT1,xG2,"-",xT3,xG2), 1)`, increasing to `r report.text2(gad_sum.out, paste(xT1,xG2,"-",xT4,xG2), 1)` Pre to Follow-up. Symptoms of social anxiety had also decreased significantly in both groups, at both Post and Follow-up: In the Unguided self-help group, the effect from Pre to Post was `r report.text2(lsas_sum.out, paste(xT1,xG1,"-",xT3,xG1), 1)`, increasing to `r report.text2(lsas_sum.out, paste(xT1,xG1,"-",xT4,xG1), 1)` Pre to Follow-up. In the Guided self-help group, the effect from Pre to Post was `r report.text2(lsas_sum.out, paste(xT1,xG2,"-",xT3,xG2), 1)`, increasing to `r report.text2(lsas_sum.out, paste(xT1,xG2,"-",xT4,xG2), 1)` Pre to Follow-up. Although effect sizes for GAD-7 and LSAS-SR increased from medium Pre--Post-up to large Pre--Follow-up, there was no significant difference between Post and Follow-up in either group, for either measure. -->

### Clinical significant change

#### Reliable recovery with regards to assertive behaviors

Adding to the picture that assertive behaviors increased as a consequence of participation in the intervention, there was a significant difference between the groups at Post in the proportion of participants that had recovered clinically, that is had moved across the cutoff for reliable and clinically significant change, with respect to AAA-S Adaptive, `r report.kw(aaas_ad.pre.post.kw)` and the RAS, `r report.kw(rathus.pre.post.kw)`. At Follow-up, the proportions of the 'Recovered' category were also significantly different for AAA-S Adaptive, `r report.kw(aaas_ad.pre.fu.kw)`, and for the RAS, `r report.kw(rathus.pre.fu.kw)`. However, there was not difference in the proportions of recovered participants with regards to AAA-S Aggressive at either time-point.

Notably, a number of participants, `r clinsigtext("aaas_ad", "higher", xT1, xT3, xG1, aaas_ad.pre.post.kw)[1]` in the Unguided self-help group enjoyed clinical recovery with regards to adaptive assertiveness measured with AAA-S Adaptive at Post, increasing to `r clinsigtext("aaas_ad", "higher", xT1, xT4, xG1, aaas_ad.pre.fu.kw)[1]` at Follow-up. In the Guided self-help group the number of recovered participants at Post was non-significantly different from that of the Waitlist, while significantly different at Followup, `r clinsigtext("aaas_ad", "higher", xT1, xT4, xG2, aaas_ad.pre.fu.kw)[1]`. For assertiveness assessed with the RAS, the corresponding numbers (and percentages) were `r clinsigtext("rathus", "higher", xT1, xT3, xG1, rathus.pre.post.kw)[1]` for the Unguided self-help condition and `r clinsigtext("rathus", "higher", xT1, xT3, xG2, rathus.pre.post.kw)[1]` for the Guided self-help condition at Post, increasing to `r clinsigtext("rathus", "higher", xT1, xT4, xG1, rathus.pre.fu.kw)[1]` and `r clinsigtext("rathus", "higher", xT1, xT4, xG2, rathus.pre.fu.kw)[1]` respectively at Follow-up. 

Thus, the clinical significance findings are mostly in agreement with the statistical analysis of change, confirming that adaptive expressions of assertiveness in both treatment groups increased Pre to Post, and beyond, while deviating with regards to aggressive expressions. 

#### Reliable recovery with regards to syndromal symptoms

As for the syndromal symptoms, the proportions of those of social phobia as captured with LSAS-SR was significantly different between groups at Post, `r report.kw(lsas_sum.pre.post.kw)`. However, there was no difference between groups at Post with regards to PHQ-9 or GAD-7. At Follow-up, the difference in proportions of recovery between conditions was significant for PHQ-9, `r report.kw(phq_sum.pre.fu.kw)`, and LSAS-SR, `r report.kw(lsas_sum.pre.fu.kw)`, but not for GAD-7.  

Clinical recovery measured with PHQ-9 Pre to Post indicate that the intervention, compared to Waitlist, was effective in moving a number of participants out of depression in the Guided self-help group, `r clinsigtext("phq_sum", "lower", xT1, xT3, xG2, phq_sum.pre.post.kw)[1]`, but not so in Unguided self-help group, pointing to that interaction with therapists contributes to faster recovery for depressed participants. In addition, a significant number of participants in the Unguided self-help group recovered from symptoms of social anxiety as captured with LSAS-SR, `r clinsigtext("lsas_sum", "lower", xT1, xT3, xG1, lsas_sum.pre.post.kw)[1]` at Post, increasing to `r clinsigtext("lsas_sum", "lower", xT1, xT4, xG1, lsas_sum.pre.fu.kw)[1]` at Follow-up. In the Guided self-help condition, there was no significant number of recovered participants compared to Waitlist at Post, but `r clinsigtext("lsas_sum", "lower", xT1, xT4, xG2, lsas_sum.pre.fu.kw)[1]` at Follow-up. These clinical findings pick up that symptoms of social anxiety continued to subside in the year following treatment, to the point that some participants had recovered. Combined with the clinically relevant recovery for assertive behaviors measured with AAA-S Adaptive and RAS, this could be a sign of generalization of assertive behaviors having continued to occur after the end of treatment, facilitating extinction of autonomous anxiety responses and/or reducing avoidance and escape behaviors from them.

Table 3 gives a summary of numbers and proportions of clinical recovery in the different groups, and the significance, if any, of pairwise tests of those proportions against those of the Waitlist.

#### Reliable deterioration and harm

Checking for any signs of reliable harm, the most severe form of deterioration, a significant difference between groups in clinical significant change was found for the AAA-S Aggressive measure, `r report.kw(aaas_ag.pre.post.kw.harmed)`, as $n$ = $3$ participants ($4$\%) had reached below the threshold for the category 'Harmed' while waiting to enter into treatment (see Table 3). However, post hoc testing did not reveal any significant pairwise differences between any of the treatment groups and the Waitlist group, `r xprnot(aaas_ag.pre.post.kw.harmed$altP.adjusted[2],a="Bonf")` and `r xprnot(aaas_ag.pre.post.kw.harmed$altP.adjusted[1],a="Bonf")`. No other instances of suspected reliable harm Pre to Post or Pre to Follow-up were identified for either measure. The next worst category in assessing reliable change is 'Deteriorated'; in order to identify any possible cases of reliable deterioration _and_ reliable harm, these two categories were collapsed into the conservative ad hoc category 'Worsened' -- gathering participants that had moved into either of these two categories. Using the 'Worsened' portmanteau category, and checking clinical change Pre to Post treatment, we observed a significant difference between groups for LSAS-SR, `r report.kw(lsas_sum.pre.post.kw.worsened)`, meriting a follow-up pairwise comparison. It revealed that the number of participants in the Waitlist condition that had either reached 'Deteriorated' or 'Harmed', going from Pre to Post treatment, was significant compared to the Guided self-help group, $n$ = 7 ($10$\xspace\%), $Z$($2$) = `r xresult(lsas_sum.pre.post.kw.worsened$Z[2],2)`, `r xpr(lsas_sum.pre.post.kw.worsened$altP.adjusted[2],a="Bonf")`. The same held true comparing Pre to Follow-up, `r report.kw(lsas_sum.pre.fu.kw.worsened)`, where these $7$ individuals were significantly more than the number of worsened participants in both the Unguided self-help group, $Z$($2$) = `r xresult(lsas_sum.pre.fu.kw.worsened$Z[1],2)`, `r xpr(lsas_sum.pre.fu.kw.worsened$altP.adjusted[1],a="Bonf")`, and the Guided self-help group, $Z$($2$) = `r xresult(lsas_sum.pre.fu.kw.worsened$Z[2],2)`, `r xpr(lsas_sum.pre.fu.kw.worsened$altP.adjusted[2],a="Bonf")`. Finally, a difference between groups was found for PHQ-9, `r report.kw(phq_sum.pre.fu.kw.worsened)`, with post hoc testing revealing a difference for the Guided self-help group, $n$ = 12 ($18$\xspace\%), $Z$($2$) = `r xresult(phq_sum.pre.fu.kw.worsened$Z[1],2)`, `r xpr(phq_sum.pre.fu.kw.worsened$altP.adjusted[1],a="Bonf")`. These findings reveal that the non-active Waitlist condition brought about adverse clinical change for $10$\% of participants with regards to social anxiety and $18$\% with regards to depression, highlighting the need to use caution comparing results for the treatment groups with those of the Waitlist condition, lest running the risk of artificially inflated effect sizes (especially for PHQ-9 for which estimated marginal means in fact increased over time; see Figure 3).

# Discussion

<!-- The present study advances current knowledge about a stand-alone transdiagnostic intervention targeting assertiveness, Respekt^2^, providing evidence for its effects on levels of assertive behaviors, and in turn their effects on symptoms of common psychiatric disorders of anxiety and depression. Having been more or less ignored as a construct in clincical research since the 1990'ies, despite its history as a target for the very first behavioral therapies in the 1950'ies [@Speed2018a], this study brings some much-needed and up-to-date data for assertiveness as a viable transdiagnostic goal in the treatment of various clincial problems. -->

<!-- We found large between-group effects on assertiveness of Unguided self-help and Guided self-help participation in Respekt^2^, compared to Waitlist control. For AAA-S Adaptive and RAS at Post in the Unguided self-help condition, `r report.text2(aaas_ad.out, paste(xT3,xG3,"-",xT3,xG1), -1,"effshort")` and `r report.text2(rathus.out, paste(xT3,xG3,"-",xT3,xG1), -1,"effshort")` respectively. The corresponding effect sizes in the Guided self-help group was `r report.text2(aaas_ad.out, paste(xT3,xG3,"-",xT3,xG2), -1,"effshort")` and `r report.text2(rathus.out, paste(xT3,xG3,"-",xT3,xG2), -1,"effshort")` respectively. Within-group effects from Pre to Post were also large: `r report.text2(aaas_ad.out, paste(xT1,xG1,"-",xT3,xG1), -1,"effshort")` for AAA-S Adaptive in the Self-group, and `r report.text2(aaas_ad.out, paste(xT1,xG2,"-",xT3,xG2), -1,"effshort")` in the Guided self-help group; `r report.text2(rathus.out, paste(xT1,xG1,"-",xT3,xG1), -1,"effshort")` for the RAS in the Self-group, and `r report.text2(rathus.out, paste(xT1,xG2,"-",xT3,xG2), -1,"effshort")` in the Guided self-help group. For AAA-S Adaptive in the Guided self-group, the `r report.text2(rathus.out, paste(xT3,xG1,"-",xT4,xG1), -1,"effshort")` increase at 1 year Follow-up was also significant. Clinically speaking, $n$ = 15 (22%) of participants in the Unguided self-help group had recovered with regards to AAA-S Adaptive at Follow-up, while $n$ = 18 (26%) of participants in the Guided self-help group had recovered at the same time point. The corresponding recovery rates for RAS were $n$ = 21 (31%) and $n$ = 25 (36%). We conclude that Respekt^2^ did help participants act more assertively, while not acting more aggressively, and that the effects were either sustained or more pronounced 1 year after the intervention. -->

<!-- Assessing the effect of the Respekt^2^ intervention on symptom burden with respect to depression and common anxiety disorders, we found no significant effects at Post for PHQ-9 or LSAS-SR in the Unguided self-help group, compared with Waitlist. At Follow-up, however, we found a large between-group effect on LSAS-SR, `r report.text2(lsas_sum.out, paste(xT2,xG3,"-",xT4,xG1), 1,"effshort")`. Effects were also found in the Guided self-help group, where participants were supported by therapists: Compared with waitlist, participants exhibited moderate effects at Post for PHQ-9, `r report.text2(phq_sum.out, paste(xT3,xG3,"-",xT3,xG2), 1,"effshort")`, and LSAS-SR, `r report.text2(lsas_sum.out, paste(xT3,xG3,"-",xT3,xG2), 1,"effshort")` respectively, as well as a large effect only for LSAS-SR at Follow-up, `r report.text2(lsas_sum.out, paste(xT2,xG3,"-",xT4,xG2), 1,"effshort")`. Within-group comparisons revealed moderate effects in the Unguided self-help group for LSAS-SR, `r report.text2(lsas_sum.out, paste(xT1,xG1,"-",xT3,xG1), 1,"effshort")` Pre--Post, and large effects `r report.text2(lsas_sum.out, paste(xT1,xG1,"-",xT4,xG1), 1,"effshort")` Pre--Follow-up. Similar effects were found in the Guided self-help group, `r report.text2(lsas_sum.out, paste(xT1,xG2,"-",xT3,xG2), 1,"effshort")` Pre--Post, and `r report.text2(lsas_sum.out, paste(xT1,xG2,"-",xT4,xG2), 1,"effshort")` Pre--Follow-up. A moderate effect was found for PHQ-9 Pre--Follow-up for the Guided self-help group, `r report.text2(phq_sum.out, paste(xT1,xG2,"-",xT4,xG2), 1,"effshort")`. These findings were supplemented by the analysis of clinical significant change, where, $n$ = 14 (21%) had recovered from social anxiety at Follow-up in the Unguided self-help group, and $n$ = 18 (26%) in the group that were guided by therapists. In addition, $n$ = 18 (26%) in the Guided self-help group had recovered from depression at Follow-up. Thus, we found that Respekt^2^ clearly reduced symptoms of social anxiety across both treatment conditions, and over time possibly reduced symptoms of depression, to a moderate degree, among participants that were guided by therapists. -->

<!-- Contextualize the current study w/ regards to assertiveness, @Speed2018a (lack of up-to-date research outside of DBT), while @Day2013, @Rozental2015, @Rozental2017 pointing to transdiagnostic interventions as potentially beneficial.  -->

<!-- (Compare effects with literature for iCBT, @Carlbring2018 (iCBT as effective as face-to-face treatment), @Andrews2018 (iCBT effective, acceptable, average between-group effect size g = 0.8 compared to controls; results from @Baumeister2014a concur, also pointing to guided iCBT producing somewhat larger effects than non-guided). Also, compare w/ frequencies or reliable change, e.g. @Rozental2015.) -->

<!-- (Discuss effects as they related to sociodemographic baseline characteristics -- 60\% having previously been in therapy; Respekt^2^ possibly acting as a booster ..., also a very pronounced sex difference, also level of use of medication.) -->

<!-- In line with @Baumeister2014a, the results of the current study suggest that while effects at Post and Follow-up between groups are comparable for all measures, being guided by a therapist in iCBT could entail some advantages, especially for longer-term outcomes. In the Guided self-help group, adaptive assertiveness had increased between end of treatment and 1-year Follow-up, and both analysis within-groups and of statistical change indicated that depression had decreased from pre-treatment to 1-year Follow-up both. These phenomena were not observed in the group where the participants were engaging with the intervention on their own. Speculatively, this might be explained by either increased willingness to participate in behavioral experiments through the effects of coaching, an increased ability to engage in behavioral experiments through active problem solving with the therapist, or increased ability to generalize findings from such experiments through better compliance to homework assignments, or any combination thereof. While the mechanisms of mediation and moderation remain to unravel, the presence of human support could increase adherence to the intervention through increased levels of accountability, as suggested by @Mohr2011. -->

<!-- (Discuss reasons for non-responding with regards to GAD-7? Relate to the sample.) -->

<!-- Limitations: Although the effect sizes between groups and within treatment groups were substantial in the Respekt^2^ intervention, it is difficult to transfer the findings to the general population. Firstly, X, secondly, Y, ... The current study also suffers from a number of limitations, among them Z (biased recruitment), Å (unclear operationalization of 'assertiveness'), Ä (no validated scales), Ö (waitlist as control, related to reliable harm). -->

<!-- Future research: However, it is intriguing that ..., and merits further investigation. Directions for future research could include ... (how does assertiveness relate to relationship problems and work-related stress?) -->

<!-- Apart from psychiatric syndromes, assertiveness has been linked to relationship problems and with work-related stress [@Speed2018a]. For future research, we propose investigations of links between unassertiveness and these issues, that are sometimes non-clinical but nevertheless are associated with suffering and problems in living. Furthermore, investigations on clinical populations are merited, comparing the effects of Respekt^2^ with manualized treatments commonly deployed in psychiatric settings for syndromes that are associated with lack of assertiveness. On the other end of the spectrum, a trial assessing the viability and acceptability of the assertiveness construct as a target in a preventive intervention for both clinical and non-clincial problems is warranted; assertiveness as a transdiagnostic construct could be used flexibly in a multitude of settings and with a multitude of populations. Lastly, we propose a follow-up to the present study, in which the intervention would again be administered to a non-clinical audience, this time using an extended battery of measures, including scales capturing positively formulated transdiagnostic behaviors such as the Valued Living Questionnaire [VLQ\; @Wilson2010] and the Acceptance and Action Questionnaire (AAQ-II; ref). -->

<!-- Lösrykta tankar/stycken att eventuellt utveckla: -->

<!-- - Kolla upp hur många som faktiskt försvann mellan modulerna, jämför med power-beräkningen. Kolla hur många som gav fu-svar. -->

<!-- - Jämföra engagemang mellan grupperna? Antal inloggningar? Antal gjorda hemuppgifter? -->

<!-- - Diskutera huvudeffekter för AAA-S Aggressive och GAD-7 trots avsaknad av interation tid x grupp? Hur tänka? -->

<!-- - Samla upp viktigaste punkterna från uppsatsen. -->

<!-- - Problematisering av otydlig defintion av assertivenss. R2? Adaptiv, aggressiv? Passiv? Passiv-aggressiv? Icke-undvikande/icke-flykt? Det enda som är säkert är att definitionen nog endast bör rymma overta beteenden? -->

<!-- - Man kan ha olika uppfattning om vad som är aggressiv vs adaptiv självhävdelse, finns behov av att mäta dessa antaganden på något adekvat sätt. Att följa upp? -->

<!-- - Skalorna är inte validerade på svenska. -->

<!-- - Behöver testas med en klinisk population, inte bara allmänhet rekryterade via sociala medier. -->

<!-- - Hade varit bättre med också random slopes. -->

<!-- - Problem med ITT -- fångar inte ev försämring ... men vi får anta att regression to the mean gäller även här. -->

<!-- - Problematisering väntelista som kontroll, hantering av problem. It is noteworthy that the PHQ-9 mean of the non-active Waitlist control group increases as the participants wait in line to begin treatment; this might be due to the nocebo or ”reverse placebo” effect [@Furukawa2014;@Cuijpers2016], where participants’ expectations contribute to their mood actually worsening, which in turn risks inflating between group effect sizes. The other scales do not exhibit this possible problem. To mitigate any possible nocebo effect, the most conservative estimated marginal mean from either the Pre, During, Post time points was used for all within group pairwise comparisons for each scale. -->

<!-- - Jag vill säga något spekulativt om rimligheten och önskvärdheten att använda positivt formulerat, transdiagnostiskt beteendemål i behandling istf syndromal symptomreduktion. Relatera till utfallsmåtten PHQ9, GAD7, LSAS. Det är väntat att beteendemåtten (AAAS-ad/ag, RAS) sticker iväg snabbare än symtomreduktionsmåtten. Beteendeförändring borde föregå förändring i upplevelse (känslor, tankar). Validerar mao beteendeterapeutiska angreppssättet? -->

<!-- - För en replikering vore det intressant att använda andra transdiagnostiska skalor kopplade till värderat handlande, typ VLQ, och även SAAQ. -->

<!-- - En fördel med självständigt arbete (som när man går i ett självhjälpsprogram) är sannolikt att man tillskriver förbättringar till sig själv och egna förändrade beteenden än till kontakten med terapeuten -- skulle spekulativt kunna utgöra en del av förklaringen till att självshjälpsgruppen gjort så stora framsteg på egen hand när effekten mäts med positivt formulerade självhävdelsebeteendemål. Med andra ord synliggörs faktiska beteendeförändringar möjligen bättre. -->

<!-- - ... -->

<!-- - ... -->

## References {.allowframebreaks}

```{r references, echo = F, eval = T}

knitr::write_bib(packages, "packages.bib")

```

\small